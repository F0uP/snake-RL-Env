{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000002, "total_loss": 4.474903404712677, "policy_loss": 0.2543507817387581, "vf_loss": 7.190351181030273, "vf_explained_var": 0.028270479440689087, "kl": 0.6253841292622656, "entropy": 0.7093878479510775, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 6.0, "episode_reward_mean": 25.0188679245283, "episode_len_mean": 27.0188679245283, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 12.0, 14.0, 19.0, 14.0, 27.0, 27.0, 12.0, 30.0, 6.0, 9.0, 13.0, 28.0, 43.0, 26.0, 54.0, 55.0, 24.0, 19.0, 27.0, 30.0, 19.0, 16.0, 45.0, 36.0, 10.0, 38.0, 27.0, 30.0, 9.0, 23.0, 28.0, 9.0, 8.0, 8.0, 19.0, 20.0, 21.0, 33.0, 36.0, 11.0, 47.0, 48.0, 7.0, 24.0, 45.0, 71.0, 13.0, 6.0, 42.0, 41.0, 11.0, 28.0], "episode_lengths": [10, 14, 16, 21, 16, 29, 29, 14, 32, 8, 11, 15, 30, 45, 28, 56, 57, 26, 21, 29, 32, 21, 18, 47, 38, 12, 40, 29, 32, 11, 25, 30, 11, 10, 10, 21, 22, 23, 35, 38, 13, 49, 50, 9, 26, 47, 73, 15, 8, 44, 43, 13, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.392514527233743, "mean_inference_ms": 44.71168334564717, "mean_action_processing_ms": 1.6391004733052312, "mean_env_wait_ms": 95.1404173797744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0189434807255583, "ObsPreprocessorConnector_ms": 0.024504931467883993, "StateBufferConnector_ms": 0.00947871298160193, "ViewRequirementAgentConnector_ms": 0.30772416096813276}}, "episode_reward_max": 71.0, "episode_reward_min": 6.0, "episode_reward_mean": 25.0188679245283, "episode_len_mean": 27.0188679245283, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.0, 12.0, 14.0, 19.0, 14.0, 27.0, 27.0, 12.0, 30.0, 6.0, 9.0, 13.0, 28.0, 43.0, 26.0, 54.0, 55.0, 24.0, 19.0, 27.0, 30.0, 19.0, 16.0, 45.0, 36.0, 10.0, 38.0, 27.0, 30.0, 9.0, 23.0, 28.0, 9.0, 8.0, 8.0, 19.0, 20.0, 21.0, 33.0, 36.0, 11.0, 47.0, 48.0, 7.0, 24.0, 45.0, 71.0, 13.0, 6.0, 42.0, 41.0, 11.0, 28.0], "episode_lengths": [10, 14, 16, 21, 16, 29, 29, 14, 32, 8, 11, 15, 30, 45, 28, 56, 57, 26, 21, 29, 32, 21, 18, 47, 38, 12, 40, 29, 32, 11, 25, 30, 11, 10, 10, 21, 22, 23, 35, 38, 13, 49, 50, 9, 26, 47, 73, 15, 8, 44, 43, 13, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.392514527233743, "mean_inference_ms": 44.71168334564717, "mean_action_processing_ms": 1.6391004733052312, "mean_env_wait_ms": 95.1404173797744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0189434807255583, "ObsPreprocessorConnector_ms": 0.024504931467883993, "StateBufferConnector_ms": 0.00947871298160193, "ViewRequirementAgentConnector_ms": 0.30772416096813276}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 36429.188, "load_time_ms": 155.837, "load_throughput": 12833.937, "learn_time_ms": 16300.631, "learn_throughput": 122.695, "synch_weights_time_ms": 9.951}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "done": false, "episodes_total": 53, "training_iteration": 1, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-05-08", "timestamp": 1682359508, "time_this_iter_s": 36.44376540184021, "time_total_s": 36.44376540184021, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf46b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 36.44376540184021, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.5843137254902, "ram_util_percent": 43.42156862745098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.00010000000000000002, "total_loss": 4.153847571611404, "policy_loss": 0.25000416848808527, "vf_loss": 7.805661749839783, "vf_explained_var": 0.006240882873535156, "kl": 0.0006800497083531809, "entropy": 0.7606660908460617, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 167.0, "episode_reward_min": 6.0, "episode_reward_mean": 32.86, "episode_len_mean": 34.86, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 12.0, 30.0, 6.0, 9.0, 13.0, 28.0, 43.0, 26.0, 54.0, 55.0, 24.0, 19.0, 27.0, 30.0, 19.0, 16.0, 45.0, 36.0, 10.0, 38.0, 27.0, 30.0, 9.0, 23.0, 28.0, 9.0, 8.0, 8.0, 19.0, 20.0, 21.0, 33.0, 36.0, 11.0, 47.0, 48.0, 7.0, 24.0, 45.0, 71.0, 13.0, 6.0, 42.0, 41.0, 11.0, 28.0, 21.0, 16.0, 39.0, 33.0, 43.0, 7.0, 38.0, 15.0, 14.0, 63.0, 38.0, 11.0, 21.0, 12.0, 18.0, 60.0, 23.0, 80.0, 30.0, 39.0, 25.0, 48.0, 35.0, 75.0, 31.0, 7.0, 35.0, 10.0, 44.0, 18.0, 20.0, 90.0, 13.0, 126.0, 17.0, 26.0, 42.0, 54.0, 11.0, 131.0, 11.0, 20.0, 27.0, 34.0, 26.0, 41.0, 36.0, 21.0, 167.0, 28.0, 8.0, 59.0, 97.0], "episode_lengths": [29, 14, 32, 8, 11, 15, 30, 45, 28, 56, 57, 26, 21, 29, 32, 21, 18, 47, 38, 12, 40, 29, 32, 11, 25, 30, 11, 10, 10, 21, 22, 23, 35, 38, 13, 49, 50, 9, 26, 47, 73, 15, 8, 44, 43, 13, 30, 23, 18, 41, 35, 45, 9, 40, 17, 16, 65, 40, 13, 23, 14, 20, 62, 25, 82, 32, 41, 27, 50, 37, 77, 33, 9, 37, 12, 46, 20, 22, 92, 15, 128, 19, 28, 44, 56, 13, 133, 13, 22, 29, 36, 28, 43, 38, 23, 169, 30, 10, 61, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.53212367390818, "mean_inference_ms": 43.91691292126738, "mean_action_processing_ms": 1.6527635454221357, "mean_env_wait_ms": 92.78202499217522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019138336181640625, "ObsPreprocessorConnector_ms": 0.018416881561279297, "StateBufferConnector_ms": 0.01035761833190918, "ViewRequirementAgentConnector_ms": 0.28603029251098633}}, "episode_reward_max": 167.0, "episode_reward_min": 6.0, "episode_reward_mean": 32.86, "episode_len_mean": 34.86, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, 12.0, 30.0, 6.0, 9.0, 13.0, 28.0, 43.0, 26.0, 54.0, 55.0, 24.0, 19.0, 27.0, 30.0, 19.0, 16.0, 45.0, 36.0, 10.0, 38.0, 27.0, 30.0, 9.0, 23.0, 28.0, 9.0, 8.0, 8.0, 19.0, 20.0, 21.0, 33.0, 36.0, 11.0, 47.0, 48.0, 7.0, 24.0, 45.0, 71.0, 13.0, 6.0, 42.0, 41.0, 11.0, 28.0, 21.0, 16.0, 39.0, 33.0, 43.0, 7.0, 38.0, 15.0, 14.0, 63.0, 38.0, 11.0, 21.0, 12.0, 18.0, 60.0, 23.0, 80.0, 30.0, 39.0, 25.0, 48.0, 35.0, 75.0, 31.0, 7.0, 35.0, 10.0, 44.0, 18.0, 20.0, 90.0, 13.0, 126.0, 17.0, 26.0, 42.0, 54.0, 11.0, 131.0, 11.0, 20.0, 27.0, 34.0, 26.0, 41.0, 36.0, 21.0, 167.0, 28.0, 8.0, 59.0, 97.0], "episode_lengths": [29, 14, 32, 8, 11, 15, 30, 45, 28, 56, 57, 26, 21, 29, 32, 21, 18, 47, 38, 12, 40, 29, 32, 11, 25, 30, 11, 10, 10, 21, 22, 23, 35, 38, 13, 49, 50, 9, 26, 47, 73, 15, 8, 44, 43, 13, 30, 23, 18, 41, 35, 45, 9, 40, 17, 16, 65, 40, 13, 23, 14, 20, 62, 25, 82, 32, 41, 27, 50, 37, 77, 33, 9, 37, 12, 46, 20, 22, 92, 15, 128, 19, 28, 44, 56, 13, 133, 13, 22, 29, 36, 28, 43, 38, 23, 169, 30, 10, 61, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.53212367390818, "mean_inference_ms": 43.91691292126738, "mean_action_processing_ms": 1.6527635454221357, "mean_env_wait_ms": 92.78202499217522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019138336181640625, "ObsPreprocessorConnector_ms": 0.018416881561279297, "StateBufferConnector_ms": 0.01035761833190918, "ViewRequirementAgentConnector_ms": 0.28603029251098633}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 35878.52, "load_time_ms": 151.09, "load_throughput": 13237.183, "learn_time_ms": 16179.186, "learn_throughput": 123.616, "synch_weights_time_ms": 9.645}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 106, "training_iteration": 2, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-05-43", "timestamp": 1682359543, "time_this_iter_s": 35.336029052734375, "time_total_s": 71.77979445457458, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf433ee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf4da3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 71.77979445457458, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.25208333333335, "ram_util_percent": 45.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.75, "cur_lr": 0.00010000000000000002, "total_loss": 4.196322189569473, "policy_loss": 0.25368168044835326, "vf_loss": 7.883826668262482, "vf_explained_var": -0.013692813813686372, "kl": 0.0009796043888127314, "entropy": 0.7542457610368729, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "sampler_results": {"episode_reward_max": 167.0, "episode_reward_min": 7.0, "episode_reward_mean": 34.42, "episode_len_mean": 36.42, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 12.0, 18.0, 60.0, 23.0, 80.0, 30.0, 39.0, 25.0, 48.0, 35.0, 75.0, 31.0, 7.0, 35.0, 10.0, 44.0, 18.0, 20.0, 90.0, 13.0, 126.0, 17.0, 26.0, 42.0, 54.0, 11.0, 131.0, 11.0, 20.0, 27.0, 34.0, 26.0, 41.0, 36.0, 21.0, 167.0, 28.0, 8.0, 59.0, 97.0, 13.0, 45.0, 16.0, 45.0, 53.0, 21.0, 37.0, 11.0, 26.0, 14.0, 41.0, 15.0, 16.0, 39.0, 49.0, 38.0, 8.0, 50.0, 15.0, 32.0, 40.0, 14.0, 7.0, 77.0, 9.0, 13.0, 76.0, 25.0, 31.0, 58.0, 64.0, 14.0, 38.0, 22.0, 12.0, 17.0, 17.0, 11.0, 35.0, 11.0, 10.0, 44.0, 19.0, 91.0, 13.0, 19.0, 27.0, 11.0, 15.0, 11.0, 25.0, 17.0, 25.0, 10.0, 26.0, 34.0, 47.0, 76.0, 31.0], "episode_lengths": [23, 14, 20, 62, 25, 82, 32, 41, 27, 50, 37, 77, 33, 9, 37, 12, 46, 20, 22, 92, 15, 128, 19, 28, 44, 56, 13, 133, 13, 22, 29, 36, 28, 43, 38, 23, 169, 30, 10, 61, 99, 15, 47, 18, 47, 55, 23, 39, 13, 28, 16, 43, 17, 18, 41, 51, 40, 10, 52, 17, 34, 42, 16, 9, 79, 11, 15, 78, 27, 33, 60, 66, 16, 40, 24, 14, 19, 19, 13, 37, 13, 12, 46, 21, 93, 15, 21, 29, 13, 17, 13, 27, 19, 27, 12, 28, 36, 49, 78, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.608537486733624, "mean_inference_ms": 44.09365711057522, "mean_action_processing_ms": 1.6577039503290254, "mean_env_wait_ms": 90.30476895587053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018672466278076172, "ObsPreprocessorConnector_ms": 0.010752677917480469, "StateBufferConnector_ms": 0.020689725875854492, "ViewRequirementAgentConnector_ms": 0.29715704917907715}}, "episode_reward_max": 167.0, "episode_reward_min": 7.0, "episode_reward_mean": 34.42, "episode_len_mean": 36.42, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 12.0, 18.0, 60.0, 23.0, 80.0, 30.0, 39.0, 25.0, 48.0, 35.0, 75.0, 31.0, 7.0, 35.0, 10.0, 44.0, 18.0, 20.0, 90.0, 13.0, 126.0, 17.0, 26.0, 42.0, 54.0, 11.0, 131.0, 11.0, 20.0, 27.0, 34.0, 26.0, 41.0, 36.0, 21.0, 167.0, 28.0, 8.0, 59.0, 97.0, 13.0, 45.0, 16.0, 45.0, 53.0, 21.0, 37.0, 11.0, 26.0, 14.0, 41.0, 15.0, 16.0, 39.0, 49.0, 38.0, 8.0, 50.0, 15.0, 32.0, 40.0, 14.0, 7.0, 77.0, 9.0, 13.0, 76.0, 25.0, 31.0, 58.0, 64.0, 14.0, 38.0, 22.0, 12.0, 17.0, 17.0, 11.0, 35.0, 11.0, 10.0, 44.0, 19.0, 91.0, 13.0, 19.0, 27.0, 11.0, 15.0, 11.0, 25.0, 17.0, 25.0, 10.0, 26.0, 34.0, 47.0, 76.0, 31.0], "episode_lengths": [23, 14, 20, 62, 25, 82, 32, 41, 27, 50, 37, 77, 33, 9, 37, 12, 46, 20, 22, 92, 15, 128, 19, 28, 44, 56, 13, 133, 13, 22, 29, 36, 28, 43, 38, 23, 169, 30, 10, 61, 99, 15, 47, 18, 47, 55, 23, 39, 13, 28, 16, 43, 17, 18, 41, 51, 40, 10, 52, 17, 34, 42, 16, 9, 79, 11, 15, 78, 27, 33, 60, 66, 16, 40, 24, 14, 19, 19, 13, 37, 13, 12, 46, 21, 93, 15, 21, 29, 13, 17, 13, 27, 19, 27, 12, 28, 36, 49, 78, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.608537486733624, "mean_inference_ms": 44.09365711057522, "mean_action_processing_ms": 1.6577039503290254, "mean_env_wait_ms": 90.30476895587053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018672466278076172, "ObsPreprocessorConnector_ms": 0.010752677917480469, "StateBufferConnector_ms": 0.020689725875854492, "ViewRequirementAgentConnector_ms": 0.29715704917907715}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 35800.622, "load_time_ms": 145.226, "load_throughput": 13771.601, "learn_time_ms": 16179.293, "learn_throughput": 123.615, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "done": false, "episodes_total": 165, "training_iteration": 3, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-06-19", "timestamp": 1682359579, "time_this_iter_s": 35.65206003189087, "time_total_s": 107.43185448646545, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf433d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e0afabd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 107.43185448646545, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.74, "ram_util_percent": 44.84800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.375, "cur_lr": 0.00010000000000000002, "total_loss": 4.334999681711197, "policy_loss": -0.017643749573035165, "vf_loss": 8.692406151294708, "vf_explained_var": 0.07762000024318695, "kl": 0.017195402731278193, "entropy": 0.7920968925952911, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 116.0, "episode_reward_min": 8.0, "episode_reward_mean": 18.263157894736842, "episode_len_mean": 20.263157894736842, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 39.0, 30.0, 71.0, 9.0, 13.0, 10.0, 28.0, 32.0, 11.0, 11.0, 23.0, 8.0, 38.0, 8.0, 8.0, 34.0, 8.0, 15.0, 10.0, 8.0, 24.0, 8.0, 17.0, 18.0, 34.0, 10.0, 16.0, 8.0, 8.0, 9.0, 9.0, 10.0, 8.0, 8.0, 43.0, 8.0, 8.0, 10.0, 41.0, 8.0, 16.0, 8.0, 29.0, 8.0, 8.0, 14.0, 9.0, 17.0, 13.0, 54.0, 8.0, 8.0, 9.0, 9.0, 11.0, 12.0, 58.0, 116.0, 75.0, 21.0, 20.0, 14.0, 14.0, 64.0, 8.0, 9.0, 8.0, 9.0, 8.0, 15.0, 10.0, 15.0, 15.0, 8.0, 16.0, 33.0, 10.0, 8.0, 15.0, 8.0, 8.0, 8.0, 29.0, 8.0, 24.0, 15.0, 29.0, 9.0, 10.0, 8.0, 8.0, 19.0, 18.0, 16.0, 25.0, 11.0, 10.0, 8.0, 30.0, 9.0, 10.0, 9.0, 9.0, 52.0, 9.0, 9.0, 28.0, 11.0, 37.0, 8.0, 9.0, 19.0, 8.0], "episode_lengths": [35, 41, 32, 73, 11, 15, 12, 30, 34, 13, 13, 25, 10, 40, 10, 10, 36, 10, 17, 12, 10, 26, 10, 19, 20, 36, 12, 18, 10, 10, 11, 11, 12, 10, 10, 45, 10, 10, 12, 43, 10, 18, 10, 31, 10, 10, 16, 11, 19, 15, 56, 10, 10, 11, 11, 13, 14, 60, 118, 77, 23, 22, 16, 16, 66, 10, 11, 10, 11, 10, 17, 12, 17, 17, 10, 18, 35, 12, 10, 17, 10, 10, 10, 31, 10, 26, 17, 31, 11, 12, 10, 10, 21, 20, 18, 27, 13, 12, 10, 32, 11, 12, 11, 11, 54, 11, 11, 30, 13, 39, 10, 11, 21, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.935922526299347, "mean_inference_ms": 44.805052973349255, "mean_action_processing_ms": 1.6514269360700307, "mean_env_wait_ms": 90.62243928620161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.022071286251670437, "ObsPreprocessorConnector_ms": 0.012524713549697608, "StateBufferConnector_ms": 0.019021619830215185, "ViewRequirementAgentConnector_ms": 0.34983597303691666}}, "episode_reward_max": 116.0, "episode_reward_min": 8.0, "episode_reward_mean": 18.263157894736842, "episode_len_mean": 20.263157894736842, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.0, 39.0, 30.0, 71.0, 9.0, 13.0, 10.0, 28.0, 32.0, 11.0, 11.0, 23.0, 8.0, 38.0, 8.0, 8.0, 34.0, 8.0, 15.0, 10.0, 8.0, 24.0, 8.0, 17.0, 18.0, 34.0, 10.0, 16.0, 8.0, 8.0, 9.0, 9.0, 10.0, 8.0, 8.0, 43.0, 8.0, 8.0, 10.0, 41.0, 8.0, 16.0, 8.0, 29.0, 8.0, 8.0, 14.0, 9.0, 17.0, 13.0, 54.0, 8.0, 8.0, 9.0, 9.0, 11.0, 12.0, 58.0, 116.0, 75.0, 21.0, 20.0, 14.0, 14.0, 64.0, 8.0, 9.0, 8.0, 9.0, 8.0, 15.0, 10.0, 15.0, 15.0, 8.0, 16.0, 33.0, 10.0, 8.0, 15.0, 8.0, 8.0, 8.0, 29.0, 8.0, 24.0, 15.0, 29.0, 9.0, 10.0, 8.0, 8.0, 19.0, 18.0, 16.0, 25.0, 11.0, 10.0, 8.0, 30.0, 9.0, 10.0, 9.0, 9.0, 52.0, 9.0, 9.0, 28.0, 11.0, 37.0, 8.0, 9.0, 19.0, 8.0], "episode_lengths": [35, 41, 32, 73, 11, 15, 12, 30, 34, 13, 13, 25, 10, 40, 10, 10, 36, 10, 17, 12, 10, 26, 10, 19, 20, 36, 12, 18, 10, 10, 11, 11, 12, 10, 10, 45, 10, 10, 12, 43, 10, 18, 10, 31, 10, 10, 16, 11, 19, 15, 56, 10, 10, 11, 11, 13, 14, 60, 118, 77, 23, 22, 16, 16, 66, 10, 11, 10, 11, 10, 17, 12, 17, 17, 10, 18, 35, 12, 10, 17, 10, 10, 10, 31, 10, 26, 17, 31, 11, 12, 10, 10, 21, 20, 18, 27, 13, 12, 10, 32, 11, 12, 11, 11, 54, 11, 11, 30, 13, 39, 10, 11, 21, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.935922526299347, "mean_inference_ms": 44.805052973349255, "mean_action_processing_ms": 1.6514269360700307, "mean_env_wait_ms": 90.62243928620161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.022071286251670437, "ObsPreprocessorConnector_ms": 0.012524713549697608, "StateBufferConnector_ms": 0.019021619830215185, "ViewRequirementAgentConnector_ms": 0.34983597303691666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 36054.981, "load_time_ms": 142.445, "load_throughput": 14040.481, "learn_time_ms": 16296.515, "learn_throughput": 122.726, "synch_weights_time_ms": 8.703}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 279, "training_iteration": 4, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-06-56", "timestamp": 1682359616, "time_this_iter_s": 36.82822632789612, "time_total_s": 144.26008081436157, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf46b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 144.26008081436157, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.892, "ram_util_percent": 44.583999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.375, "cur_lr": 0.00010000000000000002, "total_loss": 4.495260452032089, "policy_loss": -0.022203182965131418, "vf_loss": 9.023010802268981, "vf_explained_var": 0.12758738309144974, "kl": 0.01591029272360174, "entropy": 0.8128974854946136, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 84.0, "episode_reward_min": 8.0, "episode_reward_mean": 15.885964912280702, "episode_len_mean": 17.885964912280702, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 13.0, 14.0, 9.0, 8.0, 9.0, 8.0, 17.0, 8.0, 18.0, 9.0, 14.0, 42.0, 29.0, 9.0, 15.0, 44.0, 8.0, 17.0, 9.0, 18.0, 25.0, 27.0, 28.0, 8.0, 9.0, 9.0, 8.0, 8.0, 10.0, 8.0, 8.0, 36.0, 10.0, 9.0, 9.0, 8.0, 10.0, 17.0, 24.0, 8.0, 9.0, 9.0, 12.0, 9.0, 18.0, 8.0, 25.0, 26.0, 10.0, 34.0, 8.0, 19.0, 8.0, 16.0, 13.0, 23.0, 8.0, 21.0, 9.0, 8.0, 8.0, 11.0, 17.0, 9.0, 8.0, 29.0, 40.0, 9.0, 10.0, 8.0, 13.0, 18.0, 39.0, 17.0, 8.0, 10.0, 31.0, 21.0, 18.0, 17.0, 9.0, 10.0, 16.0, 9.0, 33.0, 21.0, 10.0, 8.0, 8.0, 14.0, 10.0, 10.0, 16.0, 72.0, 28.0, 8.0, 8.0, 17.0, 8.0, 17.0, 8.0, 8.0, 9.0, 9.0, 20.0, 84.0, 8.0, 20.0, 17.0, 8.0, 14.0, 9.0, 8.0], "episode_lengths": [28, 15, 16, 11, 10, 11, 10, 19, 10, 20, 11, 16, 44, 31, 11, 17, 46, 10, 19, 11, 20, 27, 29, 30, 10, 11, 11, 10, 10, 12, 10, 10, 38, 12, 11, 11, 10, 12, 19, 26, 10, 11, 11, 14, 11, 20, 10, 27, 28, 12, 36, 10, 21, 10, 18, 15, 25, 10, 23, 11, 10, 10, 13, 19, 11, 10, 31, 42, 11, 12, 10, 15, 20, 41, 19, 10, 12, 33, 23, 20, 19, 11, 12, 18, 11, 35, 23, 12, 10, 10, 16, 12, 12, 18, 74, 30, 10, 10, 19, 10, 19, 10, 10, 11, 11, 22, 86, 10, 22, 19, 10, 16, 11, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.794179289749312, "mean_inference_ms": 45.04329764501101, "mean_action_processing_ms": 1.6304150004052445, "mean_env_wait_ms": 90.9001237935252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.026307607951917146, "ObsPreprocessorConnector_ms": 0.011148369103147272, "StateBufferConnector_ms": 0.014774841174744723, "ViewRequirementAgentConnector_ms": 0.31389311740272924}}, "episode_reward_max": 84.0, "episode_reward_min": 8.0, "episode_reward_mean": 15.885964912280702, "episode_len_mean": 17.885964912280702, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.0, 13.0, 14.0, 9.0, 8.0, 9.0, 8.0, 17.0, 8.0, 18.0, 9.0, 14.0, 42.0, 29.0, 9.0, 15.0, 44.0, 8.0, 17.0, 9.0, 18.0, 25.0, 27.0, 28.0, 8.0, 9.0, 9.0, 8.0, 8.0, 10.0, 8.0, 8.0, 36.0, 10.0, 9.0, 9.0, 8.0, 10.0, 17.0, 24.0, 8.0, 9.0, 9.0, 12.0, 9.0, 18.0, 8.0, 25.0, 26.0, 10.0, 34.0, 8.0, 19.0, 8.0, 16.0, 13.0, 23.0, 8.0, 21.0, 9.0, 8.0, 8.0, 11.0, 17.0, 9.0, 8.0, 29.0, 40.0, 9.0, 10.0, 8.0, 13.0, 18.0, 39.0, 17.0, 8.0, 10.0, 31.0, 21.0, 18.0, 17.0, 9.0, 10.0, 16.0, 9.0, 33.0, 21.0, 10.0, 8.0, 8.0, 14.0, 10.0, 10.0, 16.0, 72.0, 28.0, 8.0, 8.0, 17.0, 8.0, 17.0, 8.0, 8.0, 9.0, 9.0, 20.0, 84.0, 8.0, 20.0, 17.0, 8.0, 14.0, 9.0, 8.0], "episode_lengths": [28, 15, 16, 11, 10, 11, 10, 19, 10, 20, 11, 16, 44, 31, 11, 17, 46, 10, 19, 11, 20, 27, 29, 30, 10, 11, 11, 10, 10, 12, 10, 10, 38, 12, 11, 11, 10, 12, 19, 26, 10, 11, 11, 14, 11, 20, 10, 27, 28, 12, 36, 10, 21, 10, 18, 15, 25, 10, 23, 11, 10, 10, 13, 19, 11, 10, 31, 42, 11, 12, 10, 15, 20, 41, 19, 10, 12, 33, 23, 20, 19, 11, 12, 18, 11, 35, 23, 12, 10, 10, 16, 12, 12, 18, 74, 30, 10, 10, 19, 10, 19, 10, 10, 11, 11, 22, 86, 10, 22, 19, 10, 16, 11, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.794179289749312, "mean_inference_ms": 45.04329764501101, "mean_action_processing_ms": 1.6304150004052445, "mean_env_wait_ms": 90.9001237935252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.026307607951917146, "ObsPreprocessorConnector_ms": 0.011148369103147272, "StateBufferConnector_ms": 0.014774841174744723, "ViewRequirementAgentConnector_ms": 0.31389311740272924}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 36203.835, "load_time_ms": 145.724, "load_throughput": 13724.565, "learn_time_ms": 16297.102, "learn_throughput": 122.721, "synch_weights_time_ms": 9.44}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 393, "training_iteration": 5, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-07-33", "timestamp": 1682359653, "time_this_iter_s": 36.81923246383667, "time_total_s": 181.07931327819824, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf4f0f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 181.07931327819824, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.85576923076923, "ram_util_percent": 44.82692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.375, "cur_lr": 0.00010000000000000002, "total_loss": 4.2700348055362705, "policy_loss": -0.029051850140094756, "vf_loss": 8.588531177043915, "vf_explained_var": 0.10574508011341095, "kl": 0.01287722498193034, "entropy": 0.7919321629405022, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 1100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 68.0, "episode_reward_min": 8.0, "episode_reward_mean": 17.485148514851485, "episode_len_mean": 19.485148514851485, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 17.0, 10.0, 15.0, 8.0, 8.0, 20.0, 24.0, 8.0, 15.0, 16.0, 15.0, 12.0, 8.0, 26.0, 9.0, 8.0, 36.0, 8.0, 8.0, 8.0, 18.0, 8.0, 18.0, 8.0, 19.0, 9.0, 9.0, 65.0, 10.0, 10.0, 16.0, 30.0, 27.0, 16.0, 18.0, 11.0, 18.0, 8.0, 16.0, 8.0, 15.0, 23.0, 8.0, 8.0, 8.0, 8.0, 9.0, 8.0, 55.0, 16.0, 9.0, 16.0, 17.0, 31.0, 21.0, 10.0, 25.0, 29.0, 16.0, 15.0, 26.0, 34.0, 9.0, 9.0, 8.0, 41.0, 16.0, 27.0, 16.0, 25.0, 15.0, 8.0, 8.0, 12.0, 33.0, 9.0, 9.0, 9.0, 32.0, 8.0, 9.0, 25.0, 38.0, 10.0, 30.0, 23.0, 29.0, 9.0, 9.0, 8.0, 17.0, 26.0, 68.0, 36.0, 10.0, 32.0, 16.0, 9.0, 9.0, 10.0], "episode_lengths": [23, 19, 12, 17, 10, 10, 22, 26, 10, 17, 18, 17, 14, 10, 28, 11, 10, 38, 10, 10, 10, 20, 10, 20, 10, 21, 11, 11, 67, 12, 12, 18, 32, 29, 18, 20, 13, 20, 10, 18, 10, 17, 25, 10, 10, 10, 10, 11, 10, 57, 18, 11, 18, 19, 33, 23, 12, 27, 31, 18, 17, 28, 36, 11, 11, 10, 43, 18, 29, 18, 27, 17, 10, 10, 14, 35, 11, 11, 11, 34, 10, 11, 27, 40, 12, 32, 25, 31, 11, 11, 10, 19, 28, 70, 38, 12, 34, 18, 11, 11, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.570502725260802, "mean_inference_ms": 44.650310350700465, "mean_action_processing_ms": 1.6224346326482775, "mean_env_wait_ms": 90.30684045613239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02108375624854966, "ObsPreprocessorConnector_ms": 0.009151732567513343, "StateBufferConnector_ms": 0.011925886173059445, "ViewRequirementAgentConnector_ms": 0.31853076254967416}}, "episode_reward_max": 68.0, "episode_reward_min": 8.0, "episode_reward_mean": 17.485148514851485, "episode_len_mean": 19.485148514851485, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 17.0, 10.0, 15.0, 8.0, 8.0, 20.0, 24.0, 8.0, 15.0, 16.0, 15.0, 12.0, 8.0, 26.0, 9.0, 8.0, 36.0, 8.0, 8.0, 8.0, 18.0, 8.0, 18.0, 8.0, 19.0, 9.0, 9.0, 65.0, 10.0, 10.0, 16.0, 30.0, 27.0, 16.0, 18.0, 11.0, 18.0, 8.0, 16.0, 8.0, 15.0, 23.0, 8.0, 8.0, 8.0, 8.0, 9.0, 8.0, 55.0, 16.0, 9.0, 16.0, 17.0, 31.0, 21.0, 10.0, 25.0, 29.0, 16.0, 15.0, 26.0, 34.0, 9.0, 9.0, 8.0, 41.0, 16.0, 27.0, 16.0, 25.0, 15.0, 8.0, 8.0, 12.0, 33.0, 9.0, 9.0, 9.0, 32.0, 8.0, 9.0, 25.0, 38.0, 10.0, 30.0, 23.0, 29.0, 9.0, 9.0, 8.0, 17.0, 26.0, 68.0, 36.0, 10.0, 32.0, 16.0, 9.0, 9.0, 10.0], "episode_lengths": [23, 19, 12, 17, 10, 10, 22, 26, 10, 17, 18, 17, 14, 10, 28, 11, 10, 38, 10, 10, 10, 20, 10, 20, 10, 21, 11, 11, 67, 12, 12, 18, 32, 29, 18, 20, 13, 20, 10, 18, 10, 17, 25, 10, 10, 10, 10, 11, 10, 57, 18, 11, 18, 19, 33, 23, 12, 27, 31, 18, 17, 28, 36, 11, 11, 10, 43, 18, 29, 18, 27, 17, 10, 10, 14, 35, 11, 11, 11, 34, 10, 11, 27, 40, 12, 32, 25, 31, 11, 11, 10, 19, 28, 70, 38, 12, 34, 18, 11, 11, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.570502725260802, "mean_inference_ms": 44.650310350700465, "mean_action_processing_ms": 1.6224346326482775, "mean_env_wait_ms": 90.30684045613239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02108375624854966, "ObsPreprocessorConnector_ms": 0.009151732567513343, "StateBufferConnector_ms": 0.011925886173059445, "ViewRequirementAgentConnector_ms": 0.31853076254967416}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 36165.045, "load_time_ms": 147.65, "load_throughput": 13545.558, "learn_time_ms": 16304.548, "learn_throughput": 122.665, "synch_weights_time_ms": 9.092}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 494, "training_iteration": 6, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-08-09", "timestamp": 1682359689, "time_this_iter_s": 35.980995655059814, "time_total_s": 217.06030893325806, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5cd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e0afabdc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 217.06030893325806, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.3918367346939, "ram_util_percent": 44.99387755102041}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1875, "cur_lr": 0.00010000000000000002, "total_loss": 4.225769506692886, "policy_loss": -0.03192377409955952, "vf_loss": 8.507375819683075, "vf_explained_var": 0.04759334057569504, "kl": 0.021404066587856506, "entropy": 0.7908874183893204, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 1300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 68.0, "episode_reward_min": 8.0, "episode_reward_mean": 22.12, "episode_len_mean": 24.12, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 9.0, 9.0, 32.0, 8.0, 9.0, 25.0, 38.0, 10.0, 30.0, 23.0, 29.0, 9.0, 9.0, 8.0, 17.0, 26.0, 68.0, 36.0, 10.0, 32.0, 16.0, 9.0, 9.0, 10.0, 28.0, 8.0, 9.0, 9.0, 27.0, 21.0, 14.0, 24.0, 19.0, 20.0, 40.0, 34.0, 8.0, 8.0, 12.0, 8.0, 39.0, 32.0, 20.0, 16.0, 24.0, 8.0, 10.0, 9.0, 58.0, 19.0, 25.0, 14.0, 36.0, 10.0, 17.0, 58.0, 8.0, 54.0, 29.0, 10.0, 10.0, 17.0, 10.0, 61.0, 14.0, 26.0, 26.0, 14.0, 10.0, 10.0, 26.0, 39.0, 40.0, 26.0, 47.0, 10.0, 9.0, 9.0, 9.0, 50.0, 24.0, 20.0, 23.0, 22.0, 9.0, 53.0, 9.0, 56.0, 29.0, 16.0, 11.0, 22.0, 25.0, 19.0, 23.0, 8.0, 21.0, 30.0, 54.0], "episode_lengths": [11, 11, 11, 34, 10, 11, 27, 40, 12, 32, 25, 31, 11, 11, 10, 19, 28, 70, 38, 12, 34, 18, 11, 11, 12, 30, 10, 11, 11, 29, 23, 16, 26, 21, 22, 42, 36, 10, 10, 14, 10, 41, 34, 22, 18, 26, 10, 12, 11, 60, 21, 27, 16, 38, 12, 19, 60, 10, 56, 31, 12, 12, 19, 12, 63, 16, 28, 28, 16, 12, 12, 28, 41, 42, 28, 49, 12, 11, 11, 11, 52, 26, 22, 25, 24, 11, 55, 11, 58, 31, 18, 13, 24, 27, 21, 25, 10, 23, 32, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.76317721458829, "mean_inference_ms": 44.21900343906674, "mean_action_processing_ms": 1.6486862565392124, "mean_env_wait_ms": 90.53756680600151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01827526092529297, "ObsPreprocessorConnector_ms": 0.011614561080932617, "StateBufferConnector_ms": 0.009959697723388672, "ViewRequirementAgentConnector_ms": 0.3355543613433838}}, "episode_reward_max": 68.0, "episode_reward_min": 8.0, "episode_reward_mean": 22.12, "episode_len_mean": 24.12, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, 9.0, 9.0, 32.0, 8.0, 9.0, 25.0, 38.0, 10.0, 30.0, 23.0, 29.0, 9.0, 9.0, 8.0, 17.0, 26.0, 68.0, 36.0, 10.0, 32.0, 16.0, 9.0, 9.0, 10.0, 28.0, 8.0, 9.0, 9.0, 27.0, 21.0, 14.0, 24.0, 19.0, 20.0, 40.0, 34.0, 8.0, 8.0, 12.0, 8.0, 39.0, 32.0, 20.0, 16.0, 24.0, 8.0, 10.0, 9.0, 58.0, 19.0, 25.0, 14.0, 36.0, 10.0, 17.0, 58.0, 8.0, 54.0, 29.0, 10.0, 10.0, 17.0, 10.0, 61.0, 14.0, 26.0, 26.0, 14.0, 10.0, 10.0, 26.0, 39.0, 40.0, 26.0, 47.0, 10.0, 9.0, 9.0, 9.0, 50.0, 24.0, 20.0, 23.0, 22.0, 9.0, 53.0, 9.0, 56.0, 29.0, 16.0, 11.0, 22.0, 25.0, 19.0, 23.0, 8.0, 21.0, 30.0, 54.0], "episode_lengths": [11, 11, 11, 34, 10, 11, 27, 40, 12, 32, 25, 31, 11, 11, 10, 19, 28, 70, 38, 12, 34, 18, 11, 11, 12, 30, 10, 11, 11, 29, 23, 16, 26, 21, 22, 42, 36, 10, 10, 14, 10, 41, 34, 22, 18, 26, 10, 12, 11, 60, 21, 27, 16, 38, 12, 19, 60, 10, 56, 31, 12, 12, 19, 12, 63, 16, 28, 28, 16, 12, 12, 28, 41, 42, 28, 49, 12, 11, 11, 11, 52, 26, 22, 25, 24, 11, 55, 11, 58, 31, 18, 13, 24, 27, 21, 25, 10, 23, 32, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.76317721458829, "mean_inference_ms": 44.21900343906674, "mean_action_processing_ms": 1.6486862565392124, "mean_env_wait_ms": 90.53756680600151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01827526092529297, "ObsPreprocessorConnector_ms": 0.011614561080932617, "StateBufferConnector_ms": 0.009959697723388672, "ViewRequirementAgentConnector_ms": 0.3355543613433838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 36156.076, "load_time_ms": 145.795, "load_throughput": 13717.859, "learn_time_ms": 16302.0, "learn_throughput": 122.684, "synch_weights_time_ms": 8.816}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 569, "training_iteration": 7, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-08-45", "timestamp": 1682359725, "time_this_iter_s": 36.11138653755188, "time_total_s": 253.17169547080994, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5bb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 253.17169547080994, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.53469387755102, "ram_util_percent": 44.81632653061225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1875, "cur_lr": 0.00010000000000000002, "total_loss": 4.071087131500244, "policy_loss": -0.024858297789323844, "vf_loss": 8.186181354522706, "vf_explained_var": 0.07910735607147217, "kl": 0.015265993414795958, "entropy": 0.7609010142087936, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 72.0, "episode_reward_min": 8.0, "episode_reward_mean": 28.3, "episode_len_mean": 30.3, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 17.0, 10.0, 61.0, 14.0, 26.0, 26.0, 14.0, 10.0, 10.0, 26.0, 39.0, 40.0, 26.0, 47.0, 10.0, 9.0, 9.0, 9.0, 50.0, 24.0, 20.0, 23.0, 22.0, 9.0, 53.0, 9.0, 56.0, 29.0, 16.0, 11.0, 22.0, 25.0, 19.0, 23.0, 8.0, 21.0, 30.0, 54.0, 49.0, 8.0, 15.0, 50.0, 72.0, 22.0, 15.0, 36.0, 56.0, 33.0, 31.0, 47.0, 8.0, 49.0, 11.0, 57.0, 18.0, 59.0, 40.0, 21.0, 32.0, 38.0, 35.0, 16.0, 9.0, 26.0, 14.0, 17.0, 63.0, 59.0, 44.0, 8.0, 27.0, 11.0, 16.0, 40.0, 9.0, 16.0, 21.0, 27.0, 15.0, 27.0, 69.0, 15.0, 45.0, 44.0, 24.0, 9.0, 31.0, 46.0, 12.0, 36.0, 25.0, 23.0, 33.0, 58.0, 52.0, 62.0, 23.0, 9.0], "episode_lengths": [12, 12, 19, 12, 63, 16, 28, 28, 16, 12, 12, 28, 41, 42, 28, 49, 12, 11, 11, 11, 52, 26, 22, 25, 24, 11, 55, 11, 58, 31, 18, 13, 24, 27, 21, 25, 10, 23, 32, 56, 51, 10, 17, 52, 74, 24, 17, 38, 58, 35, 33, 49, 10, 51, 13, 59, 20, 61, 42, 23, 34, 40, 37, 18, 11, 28, 16, 19, 65, 61, 46, 10, 29, 13, 18, 42, 11, 18, 23, 29, 17, 29, 71, 17, 47, 46, 26, 11, 33, 48, 14, 38, 27, 25, 35, 60, 54, 64, 25, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.233953680342957, "mean_inference_ms": 44.15230747942195, "mean_action_processing_ms": 1.6510581867119698, "mean_env_wait_ms": 90.6616592079131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01929926872253418, "ObsPreprocessorConnector_ms": 0.012923002243041992, "StateBufferConnector_ms": 0.010494470596313477, "ViewRequirementAgentConnector_ms": 0.33716440200805664}}, "episode_reward_max": 72.0, "episode_reward_min": 8.0, "episode_reward_mean": 28.3, "episode_len_mean": 30.3, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 10.0, 17.0, 10.0, 61.0, 14.0, 26.0, 26.0, 14.0, 10.0, 10.0, 26.0, 39.0, 40.0, 26.0, 47.0, 10.0, 9.0, 9.0, 9.0, 50.0, 24.0, 20.0, 23.0, 22.0, 9.0, 53.0, 9.0, 56.0, 29.0, 16.0, 11.0, 22.0, 25.0, 19.0, 23.0, 8.0, 21.0, 30.0, 54.0, 49.0, 8.0, 15.0, 50.0, 72.0, 22.0, 15.0, 36.0, 56.0, 33.0, 31.0, 47.0, 8.0, 49.0, 11.0, 57.0, 18.0, 59.0, 40.0, 21.0, 32.0, 38.0, 35.0, 16.0, 9.0, 26.0, 14.0, 17.0, 63.0, 59.0, 44.0, 8.0, 27.0, 11.0, 16.0, 40.0, 9.0, 16.0, 21.0, 27.0, 15.0, 27.0, 69.0, 15.0, 45.0, 44.0, 24.0, 9.0, 31.0, 46.0, 12.0, 36.0, 25.0, 23.0, 33.0, 58.0, 52.0, 62.0, 23.0, 9.0], "episode_lengths": [12, 12, 19, 12, 63, 16, 28, 28, 16, 12, 12, 28, 41, 42, 28, 49, 12, 11, 11, 11, 52, 26, 22, 25, 24, 11, 55, 11, 58, 31, 18, 13, 24, 27, 21, 25, 10, 23, 32, 56, 51, 10, 17, 52, 74, 24, 17, 38, 58, 35, 33, 49, 10, 51, 13, 59, 20, 61, 42, 23, 34, 40, 37, 18, 11, 28, 16, 19, 65, 61, 46, 10, 29, 13, 18, 42, 11, 18, 23, 29, 17, 29, 71, 17, 47, 46, 26, 11, 33, 48, 14, 38, 27, 25, 35, 60, 54, 64, 25, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.233953680342957, "mean_inference_ms": 44.15230747942195, "mean_action_processing_ms": 1.6510581867119698, "mean_env_wait_ms": 90.6616592079131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01929926872253418, "ObsPreprocessorConnector_ms": 0.012923002243041992, "StateBufferConnector_ms": 0.010494470596313477, "ViewRequirementAgentConnector_ms": 0.33716440200805664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 36197.876, "load_time_ms": 143.713, "load_throughput": 13916.637, "learn_time_ms": 16352.506, "learn_throughput": 122.305, "synch_weights_time_ms": 8.493}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 629, "training_iteration": 8, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-09-21", "timestamp": 1682359761, "time_this_iter_s": 36.49721169471741, "time_total_s": 289.66890716552734, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf46b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 289.66890716552734, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.36666666666666, "ram_util_percent": 44.462745098039214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1875, "cur_lr": 0.00010000000000000002, "total_loss": 4.240046429634094, "policy_loss": -0.02575254309689626, "vf_loss": 8.526491849422454, "vf_explained_var": 0.06653599292039872, "kl": 0.013655633489233878, "entropy": 0.7413272508978843, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 1700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 71.0, "episode_reward_min": 8.0, "episode_reward_mean": 32.71, "episode_len_mean": 34.71, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 57.0, 18.0, 59.0, 40.0, 21.0, 32.0, 38.0, 35.0, 16.0, 9.0, 26.0, 14.0, 17.0, 63.0, 59.0, 44.0, 8.0, 27.0, 11.0, 16.0, 40.0, 9.0, 16.0, 21.0, 27.0, 15.0, 27.0, 69.0, 15.0, 45.0, 44.0, 24.0, 9.0, 31.0, 46.0, 12.0, 36.0, 25.0, 23.0, 33.0, 58.0, 52.0, 62.0, 23.0, 9.0, 16.0, 14.0, 48.0, 44.0, 27.0, 33.0, 24.0, 46.0, 54.0, 58.0, 10.0, 69.0, 19.0, 70.0, 16.0, 30.0, 32.0, 12.0, 42.0, 17.0, 28.0, 62.0, 61.0, 25.0, 49.0, 36.0, 48.0, 51.0, 35.0, 48.0, 38.0, 45.0, 35.0, 16.0, 44.0, 27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0], "episode_lengths": [13, 59, 20, 61, 42, 23, 34, 40, 37, 18, 11, 28, 16, 19, 65, 61, 46, 10, 29, 13, 18, 42, 11, 18, 23, 29, 17, 29, 71, 17, 47, 46, 26, 11, 33, 48, 14, 38, 27, 25, 35, 60, 54, 64, 25, 11, 18, 16, 50, 46, 29, 35, 26, 48, 56, 60, 12, 71, 21, 72, 18, 32, 34, 14, 44, 19, 30, 64, 63, 27, 51, 38, 50, 53, 37, 50, 40, 47, 37, 18, 46, 29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.97710344597133, "mean_inference_ms": 44.363088668659564, "mean_action_processing_ms": 1.639046732523982, "mean_env_wait_ms": 91.26502060386701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.020151138305664062, "ObsPreprocessorConnector_ms": 0.018553972244262695, "StateBufferConnector_ms": 0.01104426383972168, "ViewRequirementAgentConnector_ms": 0.33962035179138184}}, "episode_reward_max": 71.0, "episode_reward_min": 8.0, "episode_reward_mean": 32.71, "episode_len_mean": 34.71, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.0, 57.0, 18.0, 59.0, 40.0, 21.0, 32.0, 38.0, 35.0, 16.0, 9.0, 26.0, 14.0, 17.0, 63.0, 59.0, 44.0, 8.0, 27.0, 11.0, 16.0, 40.0, 9.0, 16.0, 21.0, 27.0, 15.0, 27.0, 69.0, 15.0, 45.0, 44.0, 24.0, 9.0, 31.0, 46.0, 12.0, 36.0, 25.0, 23.0, 33.0, 58.0, 52.0, 62.0, 23.0, 9.0, 16.0, 14.0, 48.0, 44.0, 27.0, 33.0, 24.0, 46.0, 54.0, 58.0, 10.0, 69.0, 19.0, 70.0, 16.0, 30.0, 32.0, 12.0, 42.0, 17.0, 28.0, 62.0, 61.0, 25.0, 49.0, 36.0, 48.0, 51.0, 35.0, 48.0, 38.0, 45.0, 35.0, 16.0, 44.0, 27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0], "episode_lengths": [13, 59, 20, 61, 42, 23, 34, 40, 37, 18, 11, 28, 16, 19, 65, 61, 46, 10, 29, 13, 18, 42, 11, 18, 23, 29, 17, 29, 71, 17, 47, 46, 26, 11, 33, 48, 14, 38, 27, 25, 35, 60, 54, 64, 25, 11, 18, 16, 50, 46, 29, 35, 26, 48, 56, 60, 12, 71, 21, 72, 18, 32, 34, 14, 44, 19, 30, 64, 63, 27, 51, 38, 50, 53, 37, 50, 40, 47, 37, 18, 46, 29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.97710344597133, "mean_inference_ms": 44.363088668659564, "mean_action_processing_ms": 1.639046732523982, "mean_env_wait_ms": 91.26502060386701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.020151138305664062, "ObsPreprocessorConnector_ms": 0.018553972244262695, "StateBufferConnector_ms": 0.01104426383972168, "ViewRequirementAgentConnector_ms": 0.33962035179138184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 36180.548, "load_time_ms": 144.203, "load_throughput": 13869.332, "learn_time_ms": 16354.761, "learn_throughput": 122.289, "synch_weights_time_ms": 9.396}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 683, "training_iteration": 9, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-09-57", "timestamp": 1682359797, "time_this_iter_s": 36.060893535614014, "time_total_s": 325.72980070114136, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 325.72980070114136, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.68, "ram_util_percent": 44.734000000000016}}
{"evaluation": {"episode_reward_max": 56.0, "episode_reward_min": 7.0, "episode_reward_mean": 29.0, "episode_len_mean": 31.0, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 25.0, 27.0, 28.0, 31.0, 7.0, 44.0, 23.0, 54.0, 9.0, 56.0], "episode_lengths": [17, 27, 29, 30, 33, 9, 46, 25, 56, 11, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.393488932464082, "mean_inference_ms": 4.755444445852505, "mean_action_processing_ms": 0.759876380532475, "mean_env_wait_ms": 42.74986153942043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.008138743313876066, "ObsPreprocessorConnector_ms": 0.007115710865367542, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.13395872983065518}, "num_agent_steps_sampled_this_iter": 341, "num_env_steps_sampled_this_iter": 341, "timesteps_this_iter": 341, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 4.440357795953751, "policy_loss": -0.027030094077053944, "vf_loss": 8.929543220996857, "vf_explained_var": 0.08173861503601074, "kl": 0.027987367824680406, "entropy": 0.7512096190452575, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 1900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 86.0, "episode_reward_min": 8.0, "episode_reward_mean": 37.39, "episode_len_mean": 39.39, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 14.0, 48.0, 44.0, 27.0, 33.0, 24.0, 46.0, 54.0, 58.0, 10.0, 69.0, 19.0, 70.0, 16.0, 30.0, 32.0, 12.0, 42.0, 17.0, 28.0, 62.0, 61.0, 25.0, 49.0, 36.0, 48.0, 51.0, 35.0, 48.0, 38.0, 45.0, 35.0, 16.0, 44.0, 27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0, 65.0, 70.0, 27.0, 36.0, 32.0, 18.0, 28.0, 37.0, 53.0, 42.0, 37.0, 60.0, 66.0, 45.0, 23.0, 46.0, 66.0, 57.0, 36.0, 25.0, 15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0], "episode_lengths": [18, 16, 50, 46, 29, 35, 26, 48, 56, 60, 12, 71, 21, 72, 18, 32, 34, 14, 44, 19, 30, 64, 63, 27, 51, 38, 50, 53, 37, 50, 40, 47, 37, 18, 46, 29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20, 67, 72, 29, 38, 34, 20, 30, 39, 55, 44, 39, 62, 68, 47, 25, 48, 68, 59, 38, 27, 17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.62295916164483, "mean_inference_ms": 44.42821821263595, "mean_action_processing_ms": 1.6268868490660646, "mean_env_wait_ms": 91.67163497701763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014595270156860352, "ObsPreprocessorConnector_ms": 0.01695084571838379, "StateBufferConnector_ms": 0.012358665466308594, "ViewRequirementAgentConnector_ms": 0.33275938034057617}}, "episode_reward_max": 86.0, "episode_reward_min": 8.0, "episode_reward_mean": 37.39, "episode_len_mean": 39.39, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 14.0, 48.0, 44.0, 27.0, 33.0, 24.0, 46.0, 54.0, 58.0, 10.0, 69.0, 19.0, 70.0, 16.0, 30.0, 32.0, 12.0, 42.0, 17.0, 28.0, 62.0, 61.0, 25.0, 49.0, 36.0, 48.0, 51.0, 35.0, 48.0, 38.0, 45.0, 35.0, 16.0, 44.0, 27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0, 65.0, 70.0, 27.0, 36.0, 32.0, 18.0, 28.0, 37.0, 53.0, 42.0, 37.0, 60.0, 66.0, 45.0, 23.0, 46.0, 66.0, 57.0, 36.0, 25.0, 15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0], "episode_lengths": [18, 16, 50, 46, 29, 35, 26, 48, 56, 60, 12, 71, 21, 72, 18, 32, 34, 14, 44, 19, 30, 64, 63, 27, 51, 38, 50, 53, 37, 50, 40, 47, 37, 18, 46, 29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20, 67, 72, 29, 38, 34, 20, 30, 39, 55, 44, 39, 62, 68, 47, 25, 48, 68, 59, 38, 27, 17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.62295916164483, "mean_inference_ms": 44.42821821263595, "mean_action_processing_ms": 1.6268868490660646, "mean_env_wait_ms": 91.67163497701763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014595270156860352, "ObsPreprocessorConnector_ms": 0.01695084571838379, "StateBufferConnector_ms": 0.012358665466308594, "ViewRequirementAgentConnector_ms": 0.33275938034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 36075.586, "load_time_ms": 145.017, "load_throughput": 13791.459, "learn_time_ms": 16347.755, "learn_throughput": 122.341, "synch_weights_time_ms": 9.61}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 729, "training_iteration": 10, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-10-36", "timestamp": 1682359836, "time_this_iter_s": 38.338064193725586, "time_total_s": 364.06786489486694, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f52e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ed30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 364.06786489486694, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.89615384615385, "ram_util_percent": 44.74230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 3.7215956377983095, "policy_loss": -0.024929746049674576, "vf_loss": 7.489428894519806, "vf_explained_var": 0.060242005586624146, "kl": 0.019409912699811686, "entropy": 0.8751955944299697, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "sampler_results": {"episode_reward_max": 94.0, "episode_reward_min": 8.0, "episode_reward_mean": 40.99, "episode_len_mean": 42.99, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0, 65.0, 70.0, 27.0, 36.0, 32.0, 18.0, 28.0, 37.0, 53.0, 42.0, 37.0, 60.0, 66.0, 45.0, 23.0, 46.0, 66.0, 57.0, 36.0, 25.0, 15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0, 21.0, 43.0, 57.0, 12.0, 54.0, 16.0, 58.0, 55.0, 58.0, 54.0, 94.0, 87.0, 43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0], "episode_lengths": [29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20, 67, 72, 29, 38, 34, 20, 30, 39, 55, 44, 39, 62, 68, 47, 25, 48, 68, 59, 38, 27, 17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88, 23, 45, 59, 14, 56, 18, 60, 57, 60, 56, 96, 89, 45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.18278479502818, "mean_inference_ms": 44.27599217929596, "mean_action_processing_ms": 1.6316102738498257, "mean_env_wait_ms": 91.21711060821605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014180660247802734, "ObsPreprocessorConnector_ms": 0.010970115661621094, "StateBufferConnector_ms": 0.011306047439575195, "ViewRequirementAgentConnector_ms": 0.3016841411590576}}, "episode_reward_max": 94.0, "episode_reward_min": 8.0, "episode_reward_mean": 40.99, "episode_len_mean": 42.99, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.0, 16.0, 22.0, 16.0, 21.0, 19.0, 54.0, 27.0, 27.0, 49.0, 24.0, 71.0, 18.0, 13.0, 14.0, 37.0, 50.0, 54.0, 18.0, 65.0, 70.0, 27.0, 36.0, 32.0, 18.0, 28.0, 37.0, 53.0, 42.0, 37.0, 60.0, 66.0, 45.0, 23.0, 46.0, 66.0, 57.0, 36.0, 25.0, 15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0, 21.0, 43.0, 57.0, 12.0, 54.0, 16.0, 58.0, 55.0, 58.0, 54.0, 94.0, 87.0, 43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0], "episode_lengths": [29, 18, 24, 18, 23, 21, 56, 29, 29, 51, 26, 73, 20, 15, 16, 39, 52, 56, 20, 67, 72, 29, 38, 34, 20, 30, 39, 55, 44, 39, 62, 68, 47, 25, 48, 68, 59, 38, 27, 17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88, 23, 45, 59, 14, 56, 18, 60, 57, 60, 56, 96, 89, 45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.18278479502818, "mean_inference_ms": 44.27599217929596, "mean_action_processing_ms": 1.6316102738498257, "mean_env_wait_ms": 91.21711060821605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014180660247802734, "ObsPreprocessorConnector_ms": 0.010970115661621094, "StateBufferConnector_ms": 0.011306047439575195, "ViewRequirementAgentConnector_ms": 0.3016841411590576}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 36128.433, "load_time_ms": 142.348, "load_throughput": 14050.098, "learn_time_ms": 16396.852, "learn_throughput": 121.975, "synch_weights_time_ms": 9.525}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "done": false, "episodes_total": 764, "training_iteration": 11, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-11-13", "timestamp": 1682359873, "time_this_iter_s": 36.9644238948822, "time_total_s": 401.03228878974915, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e04459700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 401.03228878974915, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 78.99230769230768, "ram_util_percent": 45.6576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 3.486667364835739, "policy_loss": -0.028003938988549634, "vf_loss": 7.0261530327796935, "vf_explained_var": 0.08119108498096467, "kl": 0.01710294001510192, "entropy": 0.8625111594796181, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 2300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 134.0, "episode_reward_min": 8.0, "episode_reward_mean": 46.77, "episode_len_mean": 48.77, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0, 21.0, 43.0, 57.0, 12.0, 54.0, 16.0, 58.0, 55.0, 58.0, 54.0, 94.0, 87.0, 43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0, 8.0, 80.0, 39.0, 17.0, 98.0, 47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0], "episode_lengths": [17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88, 23, 45, 59, 14, 56, 18, 60, 57, 60, 56, 96, 89, 45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21, 10, 82, 41, 19, 100, 49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.94074481982119, "mean_inference_ms": 44.34909328955125, "mean_action_processing_ms": 1.6294810456439115, "mean_env_wait_ms": 91.11801632978964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014868736267089844, "ObsPreprocessorConnector_ms": 0.016424894332885742, "StateBufferConnector_ms": 0.010678768157958984, "ViewRequirementAgentConnector_ms": 0.329068660736084}}, "episode_reward_max": 134.0, "episode_reward_min": 8.0, "episode_reward_mean": 46.77, "episode_len_mean": 48.77, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.0, 49.0, 32.0, 26.0, 37.0, 50.0, 27.0, 52.0, 8.0, 56.0, 24.0, 45.0, 49.0, 32.0, 70.0, 20.0, 49.0, 34.0, 10.0, 34.0, 12.0, 46.0, 50.0, 35.0, 43.0, 86.0, 21.0, 43.0, 57.0, 12.0, 54.0, 16.0, 58.0, 55.0, 58.0, 54.0, 94.0, 87.0, 43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0, 8.0, 80.0, 39.0, 17.0, 98.0, 47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0], "episode_lengths": [17, 51, 34, 28, 39, 52, 29, 54, 10, 58, 26, 47, 51, 34, 72, 22, 51, 36, 12, 36, 14, 48, 52, 37, 45, 88, 23, 45, 59, 14, 56, 18, 60, 57, 60, 56, 96, 89, 45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21, 10, 82, 41, 19, 100, 49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.94074481982119, "mean_inference_ms": 44.34909328955125, "mean_action_processing_ms": 1.6294810456439115, "mean_env_wait_ms": 91.11801632978964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014868736267089844, "ObsPreprocessorConnector_ms": 0.016424894332885742, "StateBufferConnector_ms": 0.010678768157958984, "ViewRequirementAgentConnector_ms": 0.329068660736084}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 36250.595, "load_time_ms": 141.749, "load_throughput": 14109.48, "learn_time_ms": 16428.614, "learn_throughput": 121.739, "synch_weights_time_ms": 9.765}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 803, "training_iteration": 12, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-11-49", "timestamp": 1682359909, "time_this_iter_s": 36.56086301803589, "time_total_s": 437.59315180778503, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0e07fcfee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 437.59315180778503, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.25686274509805, "ram_util_percent": 45.907843137254915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 3.599081200361252, "policy_loss": -0.022894191532977858, "vf_loss": 7.240770592689514, "vf_explained_var": 0.06826772063970565, "kl": 0.01705120505161176, "entropy": 0.8433258247375488, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 2500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "sampler_results": {"episode_reward_max": 134.0, "episode_reward_min": 8.0, "episode_reward_mean": 49.8, "episode_len_mean": 51.8, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0, 8.0, 80.0, 39.0, 17.0, 98.0, 47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0], "episode_lengths": [45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21, 10, 82, 41, 19, 100, 49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.830720823806523, "mean_inference_ms": 44.476080136890985, "mean_action_processing_ms": 1.6195222218060183, "mean_env_wait_ms": 91.31137070574914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019898414611816406, "ObsPreprocessorConnector_ms": 0.016832828521728516, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.3539116382598877}}, "episode_reward_max": 134.0, "episode_reward_min": 8.0, "episode_reward_mean": 49.8, "episode_len_mean": 51.8, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.0, 42.0, 94.0, 38.0, 42.0, 20.0, 53.0, 30.0, 37.0, 34.0, 17.0, 58.0, 57.0, 43.0, 74.0, 46.0, 50.0, 81.0, 38.0, 42.0, 39.0, 56.0, 19.0, 8.0, 80.0, 39.0, 17.0, 98.0, 47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0], "episode_lengths": [45, 44, 96, 40, 44, 22, 55, 32, 39, 36, 19, 60, 59, 45, 76, 48, 52, 83, 40, 44, 41, 58, 21, 10, 82, 41, 19, 100, 49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.830720823806523, "mean_inference_ms": 44.476080136890985, "mean_action_processing_ms": 1.6195222218060183, "mean_env_wait_ms": 91.31137070574914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019898414611816406, "ObsPreprocessorConnector_ms": 0.016832828521728516, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.3539116382598877}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 36271.163, "load_time_ms": 143.101, "load_throughput": 13976.182, "learn_time_ms": 16443.864, "learn_throughput": 121.626, "synch_weights_time_ms": 10.224}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "done": false, "episodes_total": 841, "training_iteration": 13, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-12-25", "timestamp": 1682359945, "time_this_iter_s": 35.86415934562683, "time_total_s": 473.45731115341187, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5640>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e0afabd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 473.45731115341187, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.08979591836736, "ram_util_percent": 45.81632653061224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 3.4252426654100416, "policy_loss": -0.024413485545665026, "vf_loss": 6.8941786110401155, "vf_explained_var": 0.022486019432544708, "kl": 0.027476817505230428, "entropy": 0.9085360640287399, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 134.0, "episode_reward_min": 13.0, "episode_reward_mean": 53.14, "episode_len_mean": 55.14, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0], "episode_lengths": [49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.76225643610525, "mean_inference_ms": 44.53539805168958, "mean_action_processing_ms": 1.6093939407618556, "mean_env_wait_ms": 91.43150556238055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019801855087280273, "ObsPreprocessorConnector_ms": 0.014755487442016602, "StateBufferConnector_ms": 0.010779857635498047, "ViewRequirementAgentConnector_ms": 0.3318455219268799}}, "episode_reward_max": 134.0, "episode_reward_min": 13.0, "episode_reward_mean": 53.14, "episode_len_mean": 55.14, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.0, 17.0, 107.0, 75.0, 39.0, 43.0, 59.0, 77.0, 40.0, 36.0, 64.0, 134.0, 55.0, 55.0, 37.0, 60.0, 33.0, 28.0, 35.0, 121.0, 16.0, 48.0, 70.0, 16.0, 33.0, 21.0, 68.0, 108.0, 13.0, 61.0, 23.0, 20.0, 62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0], "episode_lengths": [49, 19, 109, 77, 41, 45, 61, 79, 42, 38, 66, 136, 57, 57, 39, 62, 35, 30, 37, 123, 18, 50, 72, 18, 35, 23, 70, 110, 15, 63, 25, 22, 64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.76225643610525, "mean_inference_ms": 44.53539805168958, "mean_action_processing_ms": 1.6093939407618556, "mean_env_wait_ms": 91.43150556238055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.019801855087280273, "ObsPreprocessorConnector_ms": 0.014755487442016602, "StateBufferConnector_ms": 0.010779857635498047, "ViewRequirementAgentConnector_ms": 0.3318455219268799}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 36190.428, "load_time_ms": 143.336, "load_throughput": 13953.258, "learn_time_ms": 16412.943, "learn_throughput": 121.855, "synch_weights_time_ms": 10.588}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 869, "training_iteration": 14, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-13-01", "timestamp": 1682359981, "time_this_iter_s": 36.02475929260254, "time_total_s": 509.4820704460144, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 509.4820704460144, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.77399999999999, "ram_util_percent": 45.865999999999985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09375, "cur_lr": 0.00010000000000000002, "total_loss": 3.371337850689888, "policy_loss": -0.019426947198226116, "vf_loss": 6.778859131336212, "vf_explained_var": 0.03147790342569351, "kl": 0.014333354078698903, "entropy": 0.8526572054624557, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 2900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": 151.0, "episode_reward_min": 10.0, "episode_reward_mean": 57.35, "episode_len_mean": 59.35, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0], "episode_lengths": [64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.65096013795285, "mean_inference_ms": 44.52651459329085, "mean_action_processing_ms": 1.6046799349445882, "mean_env_wait_ms": 91.30665722787437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018569231033325195, "ObsPreprocessorConnector_ms": 0.010649442672729492, "StateBufferConnector_ms": 0.010863065719604492, "ViewRequirementAgentConnector_ms": 0.2987194061279297}}, "episode_reward_max": 151.0, "episode_reward_min": 10.0, "episode_reward_mean": 57.35, "episode_len_mean": 59.35, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.0, 61.0, 37.0, 56.0, 61.0, 56.0, 37.0, 111.0, 39.0, 81.0, 55.0, 68.0, 43.0, 78.0, 54.0, 43.0, 45.0, 16.0, 59.0, 52.0, 59.0, 46.0, 73.0, 33.0, 31.0, 37.0, 66.0, 21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0], "episode_lengths": [64, 63, 39, 58, 63, 58, 39, 113, 41, 83, 57, 70, 45, 80, 56, 45, 47, 18, 61, 54, 61, 48, 75, 35, 33, 39, 68, 23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.65096013795285, "mean_inference_ms": 44.52651459329085, "mean_action_processing_ms": 1.6046799349445882, "mean_env_wait_ms": 91.30665722787437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018569231033325195, "ObsPreprocessorConnector_ms": 0.010649442672729492, "StateBufferConnector_ms": 0.010863065719604492, "ViewRequirementAgentConnector_ms": 0.2987194061279297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 30000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 36157.544, "load_time_ms": 140.751, "load_throughput": 14209.541, "learn_time_ms": 16449.571, "learn_throughput": 121.584, "synch_weights_time_ms": 10.02}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 901, "training_iteration": 15, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-13-38", "timestamp": 1682360018, "time_this_iter_s": 36.4790358543396, "time_total_s": 545.961106300354, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 545.961106300354, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.88431372549019, "ram_util_percent": 45.537254901960786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 3.329972223942168, "policy_loss": -0.027121077785268427, "vf_loss": 6.712507195472718, "vf_explained_var": 0.04966352462768555, "kl": 0.018073082222399534, "entropy": 0.7492406126856804, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 3100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 151.0, "episode_reward_min": 10.0, "episode_reward_mean": 61.25, "episode_len_mean": 63.25, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0], "episode_lengths": [23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.460049956131915, "mean_inference_ms": 44.45453238612049, "mean_action_processing_ms": 1.6102608794255813, "mean_env_wait_ms": 91.11617019962476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013485431671142578, "ObsPreprocessorConnector_ms": 0.01380777359008789, "StateBufferConnector_ms": 0.013664007186889648, "ViewRequirementAgentConnector_ms": 0.2988924980163574}}, "episode_reward_max": 151.0, "episode_reward_min": 10.0, "episode_reward_mean": 61.25, "episode_len_mean": 63.25, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0, 62.0, 65.0, 78.0, 43.0, 28.0, 48.0, 43.0, 34.0, 35.0, 57.0, 14.0, 39.0, 16.0, 66.0, 56.0, 40.0, 66.0, 40.0, 71.0, 19.0, 54.0, 89.0, 58.0, 36.0, 61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0], "episode_lengths": [23, 64, 67, 80, 45, 30, 50, 45, 36, 37, 59, 16, 41, 18, 68, 58, 42, 68, 42, 73, 21, 56, 91, 60, 38, 63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.460049956131915, "mean_inference_ms": 44.45453238612049, "mean_action_processing_ms": 1.6102608794255813, "mean_env_wait_ms": 91.11617019962476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013485431671142578, "ObsPreprocessorConnector_ms": 0.01380777359008789, "StateBufferConnector_ms": 0.013664007186889648, "ViewRequirementAgentConnector_ms": 0.2988924980163574}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 32000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 36204.672, "load_time_ms": 139.435, "load_throughput": 14343.556, "learn_time_ms": 16450.175, "learn_throughput": 121.579, "synch_weights_time_ms": 10.394}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 928, "training_iteration": 16, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-14-14", "timestamp": 1682360054, "time_this_iter_s": 36.45780372619629, "time_total_s": 582.4189100265503, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf433cd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 582.4189100265503, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.69215686274511, "ram_util_percent": 45.71372549019608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 3.064491683244705, "policy_loss": -0.023487115763127803, "vf_loss": 6.174290276765824, "vf_explained_var": 0.008836843967437745, "kl": 0.01794442131082178, "entropy": 0.7473656040430069, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "sampler_results": {"episode_reward_max": 204.0, "episode_reward_min": 10.0, "episode_reward_mean": 68.04, "episode_len_mean": 70.04, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0], "episode_lengths": [63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.352085393322714, "mean_inference_ms": 44.46187508067743, "mean_action_processing_ms": 1.61142362646151, "mean_env_wait_ms": 91.16098836138701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01643085479736328, "ObsPreprocessorConnector_ms": 0.014028549194335938, "StateBufferConnector_ms": 0.01324152946472168, "ViewRequirementAgentConnector_ms": 0.3092079162597656}}, "episode_reward_max": 204.0, "episode_reward_min": 10.0, "episode_reward_mean": 68.04, "episode_len_mean": 70.04, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.0, 63.0, 61.0, 66.0, 69.0, 52.0, 102.0, 48.0, 58.0, 43.0, 118.0, 51.0, 52.0, 104.0, 41.0, 29.0, 55.0, 65.0, 124.0, 67.0, 34.0, 151.0, 10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0], "episode_lengths": [63, 65, 63, 68, 71, 54, 104, 50, 60, 45, 120, 53, 54, 106, 43, 31, 57, 67, 126, 69, 36, 153, 12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.352085393322714, "mean_inference_ms": 44.46187508067743, "mean_action_processing_ms": 1.61142362646151, "mean_env_wait_ms": 91.16098836138701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01643085479736328, "ObsPreprocessorConnector_ms": 0.014028549194335938, "StateBufferConnector_ms": 0.01324152946472168, "ViewRequirementAgentConnector_ms": 0.3092079162597656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 34000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 36143.644, "load_time_ms": 140.676, "load_throughput": 14217.028, "learn_time_ms": 16459.71, "learn_throughput": 121.509, "synch_weights_time_ms": 10.272}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "done": false, "episodes_total": 953, "training_iteration": 17, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-14-50", "timestamp": 1682360090, "time_this_iter_s": 35.498796701431274, "time_total_s": 617.9177067279816, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd100>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e04459700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 617.9177067279816, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.98979591836736, "ram_util_percent": 45.82653061224491}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 2.5970517659187315, "policy_loss": -0.01972459992393851, "vf_loss": 5.231652244329452, "vf_explained_var": 0.00780887246131897, "kl": 0.020453487548511475, "entropy": 0.8535508072376251, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 3500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 204.0, "episode_reward_min": 10.0, "episode_reward_mean": 71.48, "episode_len_mean": 73.48, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0], "episode_lengths": [12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.345089326442256, "mean_inference_ms": 44.48260425175149, "mean_action_processing_ms": 1.6079376723053562, "mean_env_wait_ms": 91.34325609235006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016577720642089844, "ObsPreprocessorConnector_ms": 0.013846874237060547, "StateBufferConnector_ms": 0.013374090194702148, "ViewRequirementAgentConnector_ms": 0.32595372200012207}}, "episode_reward_max": 204.0, "episode_reward_min": 10.0, "episode_reward_mean": 71.48, "episode_len_mean": 73.48, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 46.0, 110.0, 82.0, 117.0, 56.0, 45.0, 82.0, 47.0, 12.0, 59.0, 137.0, 73.0, 60.0, 78.0, 17.0, 89.0, 35.0, 71.0, 43.0, 55.0, 90.0, 17.0, 37.0, 54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0], "episode_lengths": [12, 48, 112, 84, 119, 58, 47, 84, 49, 14, 61, 139, 75, 62, 80, 19, 91, 37, 73, 45, 57, 92, 19, 39, 56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.345089326442256, "mean_inference_ms": 44.48260425175149, "mean_action_processing_ms": 1.6079376723053562, "mean_env_wait_ms": 91.34325609235006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016577720642089844, "ObsPreprocessorConnector_ms": 0.013846874237060547, "StateBufferConnector_ms": 0.013374090194702148, "ViewRequirementAgentConnector_ms": 0.32595372200012207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 36000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 36043.661, "load_time_ms": 141.21, "load_throughput": 14163.254, "learn_time_ms": 16425.413, "learn_throughput": 121.763, "synch_weights_time_ms": 10.757}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 975, "training_iteration": 18, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-15-25", "timestamp": 1682360125, "time_this_iter_s": 35.497302532196045, "time_total_s": 653.4150092601776, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c5b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 653.4150092601776, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.83265306122449, "ram_util_percent": 46.22653061224489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 2.638402143418789, "policy_loss": -0.027606859113730023, "vf_loss": 5.330503548383713, "vf_explained_var": 0.023881558775901795, "kl": 0.016308634055094445, "entropy": 0.7240108770132064, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 3700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "sampler_results": {"episode_reward_max": 204.0, "episode_reward_min": 26.0, "episode_reward_mean": 76.53, "episode_len_mean": 78.53, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0], "episode_lengths": [56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.279363560781157, "mean_inference_ms": 44.49238776578487, "mean_action_processing_ms": 1.6062947021270904, "mean_env_wait_ms": 91.44837603088983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.017072439193725586, "ObsPreprocessorConnector_ms": 0.01427912712097168, "StateBufferConnector_ms": 0.016933679580688477, "ViewRequirementAgentConnector_ms": 0.34456777572631836}}, "episode_reward_max": 204.0, "episode_reward_min": 26.0, "episode_reward_mean": 76.53, "episode_len_mean": 78.53, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 62.0, 83.0, 51.0, 83.0, 107.0, 51.0, 36.0, 26.0, 113.0, 92.0, 69.0, 44.0, 105.0, 68.0, 80.0, 57.0, 35.0, 91.0, 61.0, 108.0, 65.0, 37.0, 78.0, 33.0, 63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0], "episode_lengths": [56, 64, 85, 53, 85, 109, 53, 38, 28, 115, 94, 71, 46, 107, 70, 82, 59, 37, 93, 63, 110, 67, 39, 80, 35, 65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.279363560781157, "mean_inference_ms": 44.49238776578487, "mean_action_processing_ms": 1.6062947021270904, "mean_env_wait_ms": 91.44837603088983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.017072439193725586, "ObsPreprocessorConnector_ms": 0.01427912712097168, "StateBufferConnector_ms": 0.016933679580688477, "ViewRequirementAgentConnector_ms": 0.34456777572631836}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 38000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 36071.892, "load_time_ms": 139.334, "load_throughput": 14354.039, "learn_time_ms": 16465.122, "learn_throughput": 121.469, "synch_weights_time_ms": 9.96}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "done": false, "episodes_total": 999, "training_iteration": 19, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-16-02", "timestamp": 1682360162, "time_this_iter_s": 36.33013987541199, "time_total_s": 689.7451491355896, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf4da3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 689.7451491355896, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.716, "ram_util_percent": 45.52}}
{"evaluation": {"episode_reward_max": 78.0, "episode_reward_min": 7.0, "episode_reward_mean": 29.818181818181817, "episode_len_mean": 31.818181818181817, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 21.0, 59.0, 7.0, 31.0, 13.0, 55.0, 9.0, 15.0, 78.0, 13.0], "episode_lengths": [29, 23, 61, 9, 33, 15, 57, 11, 17, 80, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.389904378534675, "mean_inference_ms": 5.118058278010443, "mean_action_processing_ms": 0.9808173546424278, "mean_env_wait_ms": 51.9730337373503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.011840733614834871, "ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.010546770962801847, "ViewRequirementAgentConnector_ms": 0.22652365944602273}, "num_agent_steps_sampled_this_iter": 350, "num_env_steps_sampled_this_iter": 350, "timesteps_this_iter": 350, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 2.5281529454886913, "policy_loss": -0.028619079077616336, "vf_loss": 5.112058215737343, "vf_explained_var": 0.017664921283721925, "kl": 0.016006752924295143, "entropy": 0.74116784542799, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 204.0, "episode_reward_min": 31.0, "episode_reward_mean": 77.86, "episode_len_mean": 79.86, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0], "episode_lengths": [65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.187688257742202, "mean_inference_ms": 44.43866258708898, "mean_action_processing_ms": 1.6058710710663364, "mean_env_wait_ms": 91.37615593820938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.021889448165893555, "ObsPreprocessorConnector_ms": 0.010988473892211914, "StateBufferConnector_ms": 0.012231826782226562, "ViewRequirementAgentConnector_ms": 0.35076141357421875}}, "episode_reward_max": 204.0, "episode_reward_min": 31.0, "episode_reward_mean": 77.86, "episode_len_mean": 79.86, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.0, 46.0, 102.0, 65.0, 112.0, 57.0, 113.0, 44.0, 48.0, 34.0, 204.0, 68.0, 65.0, 91.0, 63.0, 34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0], "episode_lengths": [65, 48, 104, 67, 114, 59, 115, 46, 50, 36, 206, 70, 67, 93, 65, 36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.187688257742202, "mean_inference_ms": 44.43866258708898, "mean_action_processing_ms": 1.6058710710663364, "mean_env_wait_ms": 91.37615593820938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.021889448165893555, "ObsPreprocessorConnector_ms": 0.010988473892211914, "StateBufferConnector_ms": 0.012231826782226562, "ViewRequirementAgentConnector_ms": 0.35076141357421875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 40000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 36160.399, "load_time_ms": 137.871, "load_throughput": 14506.288, "learn_time_ms": 16471.942, "learn_throughput": 121.419, "synch_weights_time_ms": 10.085}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1024, "training_iteration": 20, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-16-41", "timestamp": 1682360201, "time_this_iter_s": 38.83632493019104, "time_total_s": 728.5814740657806, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 728.5814740657806, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 84.32222222222221, "ram_util_percent": 45.4888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 1.993011649651453, "policy_loss": -0.026512655448168516, "vf_loss": 4.037510476112366, "vf_explained_var": 0.046179768741130826, "kl": 0.016577583421549205, "entropy": 0.8011093935370446, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 4100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": 249.0, "episode_reward_min": 31.0, "episode_reward_mean": 81.65, "episode_len_mean": 83.65, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0], "episode_lengths": [36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.090499751881367, "mean_inference_ms": 44.34751528606316, "mean_action_processing_ms": 1.607102699837404, "mean_env_wait_ms": 91.18995401235738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02261495590209961, "ObsPreprocessorConnector_ms": 0.012986183166503906, "StateBufferConnector_ms": 0.012206315994262695, "ViewRequirementAgentConnector_ms": 0.3396449089050293}}, "episode_reward_max": 249.0, "episode_reward_min": 31.0, "episode_reward_mean": 81.65, "episode_len_mean": 83.65, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.0, 52.0, 43.0, 62.0, 96.0, 159.0, 61.0, 52.0, 58.0, 49.0, 98.0, 90.0, 55.0, 49.0, 52.0, 81.0, 58.0, 126.0, 87.0, 59.0, 66.0, 53.0, 90.0, 77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0], "episode_lengths": [36, 54, 45, 64, 98, 161, 63, 54, 60, 51, 100, 92, 57, 51, 54, 83, 60, 128, 89, 61, 68, 55, 92, 79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.090499751881367, "mean_inference_ms": 44.34751528606316, "mean_action_processing_ms": 1.607102699837404, "mean_env_wait_ms": 91.18995401235738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02261495590209961, "ObsPreprocessorConnector_ms": 0.012986183166503906, "StateBufferConnector_ms": 0.012206315994262695, "ViewRequirementAgentConnector_ms": 0.3396449089050293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 42000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 35952.044, "load_time_ms": 138.034, "load_throughput": 14489.18, "learn_time_ms": 16424.967, "learn_throughput": 121.766, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 1039, "training_iteration": 21, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-17-16", "timestamp": 1682360236, "time_this_iter_s": 34.881145000457764, "time_total_s": 763.4626190662384, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddf4da3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 763.4626190662384, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.94166666666666, "ram_util_percent": 45.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 2.1944866339085274, "policy_loss": -0.028641876988112925, "vf_loss": 4.444119676053524, "vf_explained_var": 0.0057642534375190735, "kl": 0.022946340225753373, "entropy": 0.6931354810297489, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 4300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 280.0, "episode_reward_min": 31.0, "episode_reward_mean": 88.23, "episode_len_mean": 90.23, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0], "episode_lengths": [79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.094344970641018, "mean_inference_ms": 44.36020349405075, "mean_action_processing_ms": 1.6048820076424184, "mean_env_wait_ms": 91.19162469653129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.025754690170288086, "ObsPreprocessorConnector_ms": 0.017328500747680664, "StateBufferConnector_ms": 0.012307882308959961, "ViewRequirementAgentConnector_ms": 0.34482359886169434}}, "episode_reward_max": 280.0, "episode_reward_min": 31.0, "episode_reward_mean": 88.23, "episode_len_mean": 90.23, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [77.0, 56.0, 90.0, 71.0, 40.0, 86.0, 137.0, 143.0, 95.0, 118.0, 145.0, 44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0], "episode_lengths": [79, 58, 92, 73, 42, 88, 139, 145, 97, 120, 147, 46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.094344970641018, "mean_inference_ms": 44.36020349405075, "mean_action_processing_ms": 1.6048820076424184, "mean_env_wait_ms": 91.19162469653129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.025754690170288086, "ObsPreprocessorConnector_ms": 0.017328500747680664, "StateBufferConnector_ms": 0.012307882308959961, "ViewRequirementAgentConnector_ms": 0.34482359886169434}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 44000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 35959.0, "load_time_ms": 137.628, "load_throughput": 14531.881, "learn_time_ms": 16466.571, "learn_throughput": 121.458, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 1062, "training_iteration": 22, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-17-52", "timestamp": 1682360272, "time_this_iter_s": 36.62346887588501, "time_total_s": 800.0860879421234, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5a00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0e0afabd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 800.0860879421234, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.748, "ram_util_percent": 45.696000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 1.359765696208924, "policy_loss": -0.025999644557305145, "vf_loss": 2.769524273350835, "vf_explained_var": 0.11228122174739838, "kl": 0.0215340697208012, "entropy": 0.6217057888209819, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "sampler_results": {"episode_reward_max": 280.0, "episode_reward_min": 31.0, "episode_reward_mean": 89.29, "episode_len_mean": 91.29, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0], "episode_lengths": [46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.079337831698055, "mean_inference_ms": 44.38891277000981, "mean_action_processing_ms": 1.6038237945084188, "mean_env_wait_ms": 91.24344996307427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.025702238082885742, "ObsPreprocessorConnector_ms": 0.01761174201965332, "StateBufferConnector_ms": 0.01229405403137207, "ViewRequirementAgentConnector_ms": 0.34420251846313477}}, "episode_reward_max": 280.0, "episode_reward_min": 31.0, "episode_reward_mean": 89.29, "episode_len_mean": 91.29, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 84.0, 68.0, 155.0, 168.0, 125.0, 67.0, 48.0, 65.0, 50.0, 57.0, 31.0, 91.0, 140.0, 80.0, 104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0], "episode_lengths": [46, 86, 70, 157, 170, 127, 69, 50, 67, 52, 59, 33, 93, 142, 82, 106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.079337831698055, "mean_inference_ms": 44.38891277000981, "mean_action_processing_ms": 1.6038237945084188, "mean_env_wait_ms": 91.24344996307427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.025702238082885742, "ObsPreprocessorConnector_ms": 0.01761174201965332, "StateBufferConnector_ms": 0.01229405403137207, "ViewRequirementAgentConnector_ms": 0.34420251846313477}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 46000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 36027.374, "load_time_ms": 135.831, "load_throughput": 14724.203, "learn_time_ms": 16508.918, "learn_throughput": 121.147, "synch_weights_time_ms": 9.056}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "done": false, "episodes_total": 1073, "training_iteration": 23, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-18-29", "timestamp": 1682360309, "time_this_iter_s": 36.5418758392334, "time_total_s": 836.6279637813568, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf439940>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3eaf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 836.6279637813568, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.4862745098039, "ram_util_percent": 45.99607843137255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 1.7202438188885572, "policy_loss": -0.022490249639377, "vf_loss": 3.483475884348154, "vf_explained_var": 0.006548877358436584, "kl": 0.021390692008535554, "entropy": 0.6566065229475498, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 4700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 280.0, "episode_reward_min": 34.0, "episode_reward_mean": 97.43, "episode_len_mean": 99.43, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0], "episode_lengths": [106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.9922316092285, "mean_inference_ms": 44.31594284577241, "mean_action_processing_ms": 1.6059860465044806, "mean_env_wait_ms": 91.1202480916536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02578902244567871, "ObsPreprocessorConnector_ms": 0.0163424015045166, "StateBufferConnector_ms": 0.010040760040283203, "ViewRequirementAgentConnector_ms": 0.33017826080322266}}, "episode_reward_max": 280.0, "episode_reward_min": 34.0, "episode_reward_mean": 97.43, "episode_len_mean": 99.43, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [104.0, 79.0, 50.0, 86.0, 55.0, 46.0, 102.0, 49.0, 159.0, 54.0, 44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0], "episode_lengths": [106, 81, 52, 88, 57, 48, 104, 51, 161, 56, 46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.9922316092285, "mean_inference_ms": 44.31594284577241, "mean_action_processing_ms": 1.6059860465044806, "mean_env_wait_ms": 91.1202480916536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02578902244567871, "ObsPreprocessorConnector_ms": 0.0163424015045166, "StateBufferConnector_ms": 0.010040760040283203, "ViewRequirementAgentConnector_ms": 0.33017826080322266}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 48000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 36079.645, "load_time_ms": 136.211, "load_throughput": 14683.077, "learn_time_ms": 16519.271, "learn_throughput": 121.071, "synch_weights_time_ms": 9.214}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 1088, "training_iteration": 24, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-19-06", "timestamp": 1682360346, "time_this_iter_s": 36.54765295982361, "time_total_s": 873.1756167411804, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c5b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3caaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 873.1756167411804, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.40392156862745, "ram_util_percent": 45.94509803921568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 1.1186752116351273, "policy_loss": -0.019935145616764204, "vf_loss": 2.2755806405842303, "vf_explained_var": -0.06298402845859527, "kl": 0.01763359581476834, "entropy": 0.6528566890954971, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 4900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "sampler_results": {"episode_reward_max": 320.0, "episode_reward_min": 34.0, "episode_reward_mean": 105.96, "episode_len_mean": 107.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0], "episode_lengths": [46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.002687349778498, "mean_inference_ms": 44.40908958630836, "mean_action_processing_ms": 1.603156968102783, "mean_env_wait_ms": 91.24855675034105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02596306800842285, "ObsPreprocessorConnector_ms": 0.01680469512939453, "StateBufferConnector_ms": 0.007857561111450195, "ViewRequirementAgentConnector_ms": 0.31778669357299805}}, "episode_reward_max": 320.0, "episode_reward_min": 34.0, "episode_reward_mean": 105.96, "episode_len_mean": 107.96, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 63.0, 72.0, 50.0, 67.0, 41.0, 40.0, 90.0, 46.0, 101.0, 100.0, 38.0, 101.0, 34.0, 124.0, 144.0, 64.0, 105.0, 67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0], "episode_lengths": [46, 65, 74, 52, 69, 43, 42, 92, 48, 103, 102, 40, 103, 36, 126, 146, 66, 107, 69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.002687349778498, "mean_inference_ms": 44.40908958630836, "mean_action_processing_ms": 1.603156968102783, "mean_env_wait_ms": 91.24855675034105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.02596306800842285, "ObsPreprocessorConnector_ms": 0.01680469512939453, "StateBufferConnector_ms": 0.007857561111450195, "ViewRequirementAgentConnector_ms": 0.31778669357299805}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 50000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 35916.994, "load_time_ms": 136.453, "load_throughput": 14657.014, "learn_time_ms": 16492.716, "learn_throughput": 121.266, "synch_weights_time_ms": 9.267}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "done": false, "episodes_total": 1098, "training_iteration": 25, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-19-40", "timestamp": 1682360380, "time_this_iter_s": 34.85171818733215, "time_total_s": 908.0273349285126, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c6d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3eaf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 908.0273349285126, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.89166666666667, "ram_util_percent": 46.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 0.00010000000000000002, "total_loss": 1.9711566379666328, "policy_loss": -0.027375415563583375, "vf_loss": 3.9957097572088243, "vf_explained_var": 0.0016859319806098937, "kl": 0.01457040087232599, "entropy": 0.5817189498245716, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 320.0, "episode_reward_min": 35.0, "episode_reward_mean": 118.07, "episode_len_mean": 120.07, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0], "episode_lengths": [69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.908379940051454, "mean_inference_ms": 44.33143417880052, "mean_action_processing_ms": 1.604707534291805, "mean_env_wait_ms": 91.06052492131948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.020502090454101562, "ObsPreprocessorConnector_ms": 0.015978097915649414, "StateBufferConnector_ms": 0.008055925369262695, "ViewRequirementAgentConnector_ms": 0.3155958652496338}}, "episode_reward_max": 320.0, "episode_reward_min": 35.0, "episode_reward_mean": 118.07, "episode_len_mean": 120.07, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.0, 55.0, 66.0, 116.0, 43.0, 35.0, 117.0, 43.0, 84.0, 42.0, 249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0], "episode_lengths": [69, 57, 68, 118, 45, 37, 119, 45, 86, 44, 251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.908379940051454, "mean_inference_ms": 44.33143417880052, "mean_action_processing_ms": 1.604707534291805, "mean_env_wait_ms": 91.06052492131948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.020502090454101562, "ObsPreprocessorConnector_ms": 0.015978097915649414, "StateBufferConnector_ms": 0.008055925369262695, "ViewRequirementAgentConnector_ms": 0.3155958652496338}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 52000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 35937.97, "load_time_ms": 135.916, "load_throughput": 14714.995, "learn_time_ms": 16546.598, "learn_throughput": 120.871, "synch_weights_time_ms": 8.769}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 1116, "training_iteration": 26, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-20-17", "timestamp": 1682360417, "time_this_iter_s": 36.66223502159119, "time_total_s": 944.6895699501038, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 944.6895699501038, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 78.352, "ram_util_percent": 45.725999999999985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.2511857518693432, "policy_loss": -0.027936276848049602, "vf_loss": 2.5571615828201173, "vf_explained_var": 0.13186314910650254, "kl": 0.0233537587627103, "entropy": 0.6123938243091106, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 5300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 351.0, "episode_reward_min": 35.0, "episode_reward_mean": 122.84, "episode_len_mean": 124.84, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0], "episode_lengths": [251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.91541441222874, "mean_inference_ms": 44.39125348559848, "mean_action_processing_ms": 1.6032590997239573, "mean_env_wait_ms": 91.14612418596626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0200655460357666, "ObsPreprocessorConnector_ms": 0.015631914138793945, "StateBufferConnector_ms": 0.008093595504760742, "ViewRequirementAgentConnector_ms": 0.3088374137878418}}, "episode_reward_max": 351.0, "episode_reward_min": 35.0, "episode_reward_mean": 122.84, "episode_len_mean": 124.84, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [249.0, 40.0, 126.0, 174.0, 87.0, 100.0, 55.0, 170.0, 81.0, 47.0, 105.0, 140.0, 54.0, 109.0, 38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0], "episode_lengths": [251, 42, 128, 176, 89, 102, 57, 172, 83, 49, 107, 142, 56, 111, 40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.91541441222874, "mean_inference_ms": 44.39125348559848, "mean_action_processing_ms": 1.6032590997239573, "mean_env_wait_ms": 91.14612418596626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0200655460357666, "ObsPreprocessorConnector_ms": 0.015631914138793945, "StateBufferConnector_ms": 0.008093595504760742, "ViewRequirementAgentConnector_ms": 0.3088374137878418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 54000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 36027.584, "load_time_ms": 134.2, "load_throughput": 14903.132, "learn_time_ms": 16562.93, "learn_throughput": 120.752, "synch_weights_time_ms": 9.01}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 1126, "training_iteration": 27, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-20-54", "timestamp": 1682360454, "time_this_iter_s": 36.40833258628845, "time_total_s": 981.0979025363922, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43caf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3caf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 981.0979025363922, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.93800000000002, "ram_util_percent": 45.90800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.817841004151851, "policy_loss": -0.017613960249582304, "vf_loss": 3.6700485295802356, "vf_explained_var": 0.053802622854709624, "kl": 0.018636824773457194, "entropy": 0.6103278397023678, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 5500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 366.0, "episode_reward_min": 35.0, "episode_reward_mean": 131.97, "episode_len_mean": 133.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0], "episode_lengths": [40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.892974503174266, "mean_inference_ms": 44.43183350338054, "mean_action_processing_ms": 1.6041015462649026, "mean_env_wait_ms": 91.19475219026488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.021862506866455078, "ObsPreprocessorConnector_ms": 0.01587510108947754, "StateBufferConnector_ms": 0.008862733840942383, "ViewRequirementAgentConnector_ms": 0.3132948875427246}}, "episode_reward_max": 366.0, "episode_reward_min": 35.0, "episode_reward_mean": 131.97, "episode_len_mean": 133.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.0, 119.0, 114.0, 36.0, 42.0, 59.0, 113.0, 57.0, 131.0, 60.0, 234.0, 38.0, 60.0, 78.0, 177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0], "episode_lengths": [40, 121, 116, 38, 44, 61, 115, 59, 133, 62, 236, 40, 62, 80, 179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.892974503174266, "mean_inference_ms": 44.43183350338054, "mean_action_processing_ms": 1.6041015462649026, "mean_env_wait_ms": 91.19475219026488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.021862506866455078, "ObsPreprocessorConnector_ms": 0.01587510108947754, "StateBufferConnector_ms": 0.008862733840942383, "ViewRequirementAgentConnector_ms": 0.3132948875427246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 56000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 36078.842, "load_time_ms": 134.655, "load_throughput": 14852.756, "learn_time_ms": 16560.572, "learn_throughput": 120.769, "synch_weights_time_ms": 8.854}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 1140, "training_iteration": 28, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-21-30", "timestamp": 1682360490, "time_this_iter_s": 36.01844644546509, "time_total_s": 1017.1163489818573, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1017.1163489818573, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.31, "ram_util_percent": 46.062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.6360384141281248, "policy_loss": -0.023301480393856763, "vf_loss": 3.3178149926662446, "vf_explained_var": 0.05841248869895935, "kl": 0.01869781069799501, "entropy": 0.5830190721154213, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 144.26, "episode_len_mean": 146.26, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0], "episode_lengths": [179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.81416930982161, "mean_inference_ms": 44.343358760994754, "mean_action_processing_ms": 1.6080807527656997, "mean_env_wait_ms": 91.04851359528004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018760204315185547, "ObsPreprocessorConnector_ms": 0.01638960838317871, "StateBufferConnector_ms": 0.008673429489135742, "ViewRequirementAgentConnector_ms": 0.3192873001098633}}, "episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 144.26, "episode_len_mean": 146.26, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [177.0, 77.0, 51.0, 213.0, 59.0, 63.0, 280.0, 80.0, 39.0, 143.0, 106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0], "episode_lengths": [179, 79, 53, 215, 61, 65, 282, 82, 41, 145, 108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.81416930982161, "mean_inference_ms": 44.343358760994754, "mean_action_processing_ms": 1.6080807527656997, "mean_env_wait_ms": 91.04851359528004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.018760204315185547, "ObsPreprocessorConnector_ms": 0.01638960838317871, "StateBufferConnector_ms": 0.008673429489135742, "ViewRequirementAgentConnector_ms": 0.3192873001098633}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 58000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 35919.845, "load_time_ms": 134.796, "load_throughput": 14837.243, "learn_time_ms": 16516.862, "learn_throughput": 121.088, "synch_weights_time_ms": 8.724}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "done": false, "episodes_total": 1154, "training_iteration": 29, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-22-04", "timestamp": 1682360524, "time_this_iter_s": 34.742377519607544, "time_total_s": 1051.8587265014648, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cdc70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3caf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1051.8587265014648, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.07291666666667, "ram_util_percent": 45.887499999999996}}
{"evaluation": {"episode_reward_max": 55.0, "episode_reward_min": 15.0, "episode_reward_mean": 27.6, "episode_len_mean": 29.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 33.0, 18.0, 18.0, 16.0, 15.0, 55.0, 25.0, 25.0, 41.0], "episode_lengths": [32, 35, 20, 20, 18, 17, 57, 27, 27, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.976114165398383, "mean_inference_ms": 4.86102988643031, "mean_action_processing_ms": 0.9207879343340475, "mean_env_wait_ms": 48.438964351531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.009031295776367188, "ObsPreprocessorConnector_ms": 0.007636547088623047, "StateBufferConnector_ms": 0.008661746978759766, "ViewRequirementAgentConnector_ms": 0.16174793243408203}, "num_agent_steps_sampled_this_iter": 296, "num_env_steps_sampled_this_iter": 296, "timesteps_this_iter": 296, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.2220039015449584, "policy_loss": -0.0215114431110851, "vf_loss": 2.4859342498145995, "vf_explained_var": -0.1085945063829422, "kl": 0.023626708593074, "entropy": 0.5523987986147404, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 5900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 140.05, "episode_len_mean": 142.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0], "episode_lengths": [108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.83280329953427, "mean_inference_ms": 44.42041668575176, "mean_action_processing_ms": 1.6058960695481046, "mean_env_wait_ms": 91.13574709957753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015705347061157227, "ObsPreprocessorConnector_ms": 0.011809110641479492, "StateBufferConnector_ms": 0.008771657943725586, "ViewRequirementAgentConnector_ms": 0.3228476047515869}}, "episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 140.05, "episode_len_mean": 142.05, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.0, 72.0, 42.0, 224.0, 57.0, 186.0, 85.0, 59.0, 151.0, 119.0, 172.0, 59.0, 232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0], "episode_lengths": [108, 74, 44, 226, 59, 188, 87, 61, 153, 121, 174, 61, 234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.83280329953427, "mean_inference_ms": 44.42041668575176, "mean_action_processing_ms": 1.6058960695481046, "mean_env_wait_ms": 91.13574709957753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015705347061157227, "ObsPreprocessorConnector_ms": 0.011809110641479492, "StateBufferConnector_ms": 0.008771657943725586, "ViewRequirementAgentConnector_ms": 0.3228476047515869}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 60000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 35909.232, "load_time_ms": 134.337, "load_throughput": 14887.984, "learn_time_ms": 16537.022, "learn_throughput": 120.941, "synch_weights_time_ms": 8.017}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 1164, "training_iteration": 30, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-22-42", "timestamp": 1682360562, "time_this_iter_s": 37.55882430076599, "time_total_s": 1089.4175508022308, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0e043ccfd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1089.4175508022308, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.15882352941178, "ram_util_percent": 46.24313725490195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.3122311800462194, "policy_loss": -0.023975193090736865, "vf_loss": 2.671433052048087, "vf_explained_var": -0.09683200776576996, "kl": 0.021131619964144192, "entropy": 0.5418858657777309, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 6100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 144.77, "episode_len_mean": 146.77, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0], "episode_lengths": [234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.805492542548354, "mean_inference_ms": 44.412502006603134, "mean_action_processing_ms": 1.6068115267572565, "mean_env_wait_ms": 91.10700094954765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015382051467895508, "ObsPreprocessorConnector_ms": 0.01188206672668457, "StateBufferConnector_ms": 0.009648323059082031, "ViewRequirementAgentConnector_ms": 0.3129544258117676}}, "episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 144.77, "episode_len_mean": 146.77, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [232.0, 42.0, 173.0, 124.0, 204.0, 51.0, 46.0, 139.0, 269.0, 114.0, 257.0, 86.0, 60.0, 77.0, 298.0, 127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0], "episode_lengths": [234, 44, 175, 126, 206, 53, 48, 141, 271, 116, 259, 88, 62, 79, 300, 129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.805492542548354, "mean_inference_ms": 44.412502006603134, "mean_action_processing_ms": 1.6068115267572565, "mean_env_wait_ms": 91.10700094954765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015382051467895508, "ObsPreprocessorConnector_ms": 0.01188206672668457, "StateBufferConnector_ms": 0.009648323059082031, "ViewRequirementAgentConnector_ms": 0.3129544258117676}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 62000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 36043.104, "load_time_ms": 134.27, "load_throughput": 14895.386, "learn_time_ms": 16543.959, "learn_throughput": 120.89, "synch_weights_time_ms": 8.387}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "done": false, "episodes_total": 1176, "training_iteration": 31, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-23-18", "timestamp": 1682360598, "time_this_iter_s": 36.220874309539795, "time_total_s": 1125.6384251117706, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c280>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc339e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1125.6384251117706, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.2156862745098, "ram_util_percent": 46.11960784313725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.5766110192268388, "policy_loss": -0.021569242868572473, "vf_loss": 3.1955334356427194, "vf_explained_var": 0.0042437174916267395, "kl": 0.01785524969462131, "entropy": 0.4955481818318367, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 146.47, "episode_len_mean": 148.47, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0], "episode_lengths": [129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.790177583832648, "mean_inference_ms": 44.39082181904656, "mean_action_processing_ms": 1.6077635643287886, "mean_env_wait_ms": 91.03698835337487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015326261520385742, "ObsPreprocessorConnector_ms": 0.01206827163696289, "StateBufferConnector_ms": 0.009887218475341797, "ViewRequirementAgentConnector_ms": 0.32280707359313965}}, "episode_reward_max": 550.0, "episode_reward_min": 34.0, "episode_reward_mean": 146.47, "episode_len_mean": 148.47, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [127.0, 60.0, 170.0, 226.0, 320.0, 100.0, 199.0, 301.0, 112.0, 184.0, 130.0, 46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0], "episode_lengths": [129, 62, 172, 228, 322, 102, 201, 303, 114, 186, 132, 48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.790177583832648, "mean_inference_ms": 44.39082181904656, "mean_action_processing_ms": 1.6077635643287886, "mean_env_wait_ms": 91.03698835337487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015326261520385742, "ObsPreprocessorConnector_ms": 0.01206827163696289, "StateBufferConnector_ms": 0.009887218475341797, "ViewRequirementAgentConnector_ms": 0.32280707359313965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 64000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 35946.197, "load_time_ms": 135.724, "load_throughput": 14735.78, "learn_time_ms": 16499.684, "learn_throughput": 121.214, "synch_weights_time_ms": 8.763}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 1191, "training_iteration": 32, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-23-54", "timestamp": 1682360634, "time_this_iter_s": 35.656737327575684, "time_total_s": 1161.2951624393463, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43cb20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1161.2951624393463, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.24, "ram_util_percent": 45.958}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 1.4481814170256258, "policy_loss": -0.02392046552471584, "vf_loss": 2.943344398587942, "vf_explained_var": 0.01947209268808365, "kl": 0.01852374699398399, "entropy": 0.446746970936656, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 6500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 146.49, "episode_len_mean": 148.49, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0], "episode_lengths": [48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.773815490377363, "mean_inference_ms": 44.34256483325726, "mean_action_processing_ms": 1.608320748381162, "mean_env_wait_ms": 90.9788272760544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01657867431640625, "ObsPreprocessorConnector_ms": 0.01217508316040039, "StateBufferConnector_ms": 0.009956121444702148, "ViewRequirementAgentConnector_ms": 0.3246932029724121}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 146.49, "episode_len_mean": 148.49, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.0, 58.0, 202.0, 102.0, 42.0, 142.0, 120.0, 111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0], "episode_lengths": [48, 60, 204, 104, 44, 144, 122, 113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.773815490377363, "mean_inference_ms": 44.34256483325726, "mean_action_processing_ms": 1.608320748381162, "mean_env_wait_ms": 90.9788272760544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01657867431640625, "ObsPreprocessorConnector_ms": 0.01217508316040039, "StateBufferConnector_ms": 0.009956121444702148, "ViewRequirementAgentConnector_ms": 0.3246932029724121}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 66000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 35724.14, "load_time_ms": 135.875, "load_throughput": 14719.41, "learn_time_ms": 16449.402, "learn_throughput": 121.585, "synch_weights_time_ms": 8.533}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "done": false, "episodes_total": 1202, "training_iteration": 33, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-24-28", "timestamp": 1682360668, "time_this_iter_s": 34.318841218948364, "time_total_s": 1195.6140036582947, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3eaca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1195.6140036582947, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 84.03617021276595, "ram_util_percent": 46.36808510638296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 0.780181172195007, "policy_loss": -0.022030853081305396, "vf_loss": 1.6034758326597511, "vf_explained_var": 0.07989761203527451, "kl": 0.02039687721284281, "entropy": 0.3948309941589832, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 6700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 155.8, "episode_len_mean": 157.8, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0], "episode_lengths": [113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.750888645292342, "mean_inference_ms": 44.287572829665024, "mean_action_processing_ms": 1.609378047237473, "mean_env_wait_ms": 90.91278119454955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016458511352539062, "ObsPreprocessorConnector_ms": 0.012293338775634766, "StateBufferConnector_ms": 0.009867429733276367, "ViewRequirementAgentConnector_ms": 0.31443190574645996}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 155.8, "episode_len_mean": 157.8, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [111.0, 61.0, 298.0, 162.0, 91.0, 160.0, 213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0], "episode_lengths": [113, 63, 300, 164, 93, 162, 215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.750888645292342, "mean_inference_ms": 44.287572829665024, "mean_action_processing_ms": 1.609378047237473, "mean_env_wait_ms": 90.91278119454955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016458511352539062, "ObsPreprocessorConnector_ms": 0.012293338775634766, "StateBufferConnector_ms": 0.009867429733276367, "ViewRequirementAgentConnector_ms": 0.31443190574645996}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 68000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 35610.922, "load_time_ms": 134.887, "load_throughput": 14827.249, "learn_time_ms": 16428.841, "learn_throughput": 121.737, "synch_weights_time_ms": 8.115}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 1209, "training_iteration": 34, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-25-04", "timestamp": 1682360704, "time_this_iter_s": 35.406593799591064, "time_total_s": 1231.0205974578857, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf439fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1231.0205974578857, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.16041666666666, "ram_util_percent": 45.95416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0234375, "cur_lr": 0.00010000000000000002, "total_loss": 0.4508310364000499, "policy_loss": -0.0186790715996176, "vf_loss": 0.9384021398145705, "vf_explained_var": 0.07380259662866592, "kl": 0.01334343332069693, "entropy": 0.36918102830648425, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 154.85, "episode_len_mean": 156.85, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0], "episode_lengths": [215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.749928077658584, "mean_inference_ms": 44.289879813295265, "mean_action_processing_ms": 1.6080641528360216, "mean_env_wait_ms": 90.93281699470728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016214370727539062, "ObsPreprocessorConnector_ms": 0.012446880340576172, "StateBufferConnector_ms": 0.009580850601196289, "ViewRequirementAgentConnector_ms": 0.30585551261901855}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 154.85, "episode_len_mean": 156.85, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [213.0, 35.0, 92.0, 351.0, 43.0, 168.0, 47.0, 77.0, 151.0, 56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0], "episode_lengths": [215, 37, 94, 353, 45, 170, 49, 79, 153, 58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.749928077658584, "mean_inference_ms": 44.289879813295265, "mean_action_processing_ms": 1.6080641528360216, "mean_env_wait_ms": 90.93281699470728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016214370727539062, "ObsPreprocessorConnector_ms": 0.012446880340576172, "StateBufferConnector_ms": 0.009580850601196289, "ViewRequirementAgentConnector_ms": 0.30585551261901855}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 70000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 35709.886, "load_time_ms": 134.212, "load_throughput": 14901.774, "learn_time_ms": 16449.46, "learn_throughput": 121.585, "synch_weights_time_ms": 8.116}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 1215, "training_iteration": 35, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-25-40", "timestamp": 1682360740, "time_this_iter_s": 35.83873772621155, "time_total_s": 1266.8593351840973, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c250>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1266.8593351840973, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.65510204081633, "ram_util_percent": 45.783673469387764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.817536258478649, "policy_loss": -0.015751928165555, "vf_loss": 1.6662079213839025, "vf_explained_var": 0.0058458510041236875, "kl": 0.01598968611047894, "entropy": 0.3153573118895292, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 7100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 161.87, "episode_len_mean": 163.87, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0], "episode_lengths": [58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.72337997723442, "mean_inference_ms": 44.23019644024293, "mean_action_processing_ms": 1.608740821650797, "mean_env_wait_ms": 90.87824900550804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016302824020385742, "ObsPreprocessorConnector_ms": 0.012752771377563477, "StateBufferConnector_ms": 0.009731769561767578, "ViewRequirementAgentConnector_ms": 0.30360984802246094}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 161.87, "episode_len_mean": 163.87, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.0, 125.0, 366.0, 157.0, 64.0, 81.0, 222.0, 176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0], "episode_lengths": [58, 127, 368, 159, 66, 83, 224, 178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.72337997723442, "mean_inference_ms": 44.23019644024293, "mean_action_processing_ms": 1.608740821650797, "mean_env_wait_ms": 90.87824900550804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016302824020385742, "ObsPreprocessorConnector_ms": 0.012752771377563477, "StateBufferConnector_ms": 0.009731769561767578, "ViewRequirementAgentConnector_ms": 0.30360984802246094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 72000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 35626.506, "load_time_ms": 134.643, "load_throughput": 14854.145, "learn_time_ms": 16392.401, "learn_throughput": 122.008, "synch_weights_time_ms": 8.793}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 1224, "training_iteration": 36, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-26-16", "timestamp": 1682360776, "time_this_iter_s": 35.82533836364746, "time_total_s": 1302.6846735477448, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43cd90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d6dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1302.6846735477448, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.47450980392156, "ram_util_percent": 46.20392156862744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.9379867705283687, "policy_loss": -0.023184620775282383, "vf_loss": 1.9218635249882936, "vf_explained_var": -0.009373129606246948, "kl": 0.020687125911074133, "entropy": 0.27981339432299135, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 7300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 167.67, "episode_len_mean": 169.67, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0], "episode_lengths": [178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.69034144968009, "mean_inference_ms": 44.15878177886579, "mean_action_processing_ms": 1.6099368973346377, "mean_env_wait_ms": 90.80511900496644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016340255737304688, "ObsPreprocessorConnector_ms": 0.009975433349609375, "StateBufferConnector_ms": 0.009693384170532227, "ViewRequirementAgentConnector_ms": 0.30189990997314453}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 167.67, "episode_len_mean": 169.67, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [176.0, 126.0, 349.0, 142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0], "episode_lengths": [178, 128, 351, 144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.69034144968009, "mean_inference_ms": 44.15878177886579, "mean_action_processing_ms": 1.6099368973346377, "mean_env_wait_ms": 90.80511900496644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.016340255737304688, "ObsPreprocessorConnector_ms": 0.009975433349609375, "StateBufferConnector_ms": 0.009693384170532227, "ViewRequirementAgentConnector_ms": 0.30189990997314453}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 74000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 35473.613, "load_time_ms": 136.767, "load_throughput": 14623.397, "learn_time_ms": 16367.045, "learn_throughput": 122.197, "synch_weights_time_ms": 8.55}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "done": false, "episodes_total": 1231, "training_iteration": 37, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-26-50", "timestamp": 1682360810, "time_this_iter_s": 34.87732911109924, "time_total_s": 1337.562002658844, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cda30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1337.562002658844, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.34166666666668, "ram_util_percent": 46.84583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.4293133998010308, "policy_loss": -0.0111986643075943, "vf_loss": 0.8805475781066343, "vf_explained_var": 0.29142800956964493, "kl": 0.020540913850695813, "entropy": 0.24436824701726437, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 166.16, "episode_len_mean": 168.16, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0], "episode_lengths": [144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.673335178202787, "mean_inference_ms": 44.136977079659545, "mean_action_processing_ms": 1.6100271123369465, "mean_env_wait_ms": 90.77080170361441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015126466751098633, "ObsPreprocessorConnector_ms": 0.01003575325012207, "StateBufferConnector_ms": 0.00908970832824707, "ViewRequirementAgentConnector_ms": 0.3091714382171631}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 166.16, "episode_len_mean": 168.16, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [142.0, 41.0, 40.0, 350.0, 234.0, 102.0, 41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0], "episode_lengths": [144, 43, 42, 352, 236, 104, 43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.673335178202787, "mean_inference_ms": 44.136977079659545, "mean_action_processing_ms": 1.6100271123369465, "mean_env_wait_ms": 90.77080170361441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.015126466751098633, "ObsPreprocessorConnector_ms": 0.01003575325012207, "StateBufferConnector_ms": 0.00908970832824707, "ViewRequirementAgentConnector_ms": 0.3091714382171631}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 76000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 35336.306, "load_time_ms": 136.075, "load_throughput": 14697.808, "learn_time_ms": 16357.639, "learn_throughput": 122.267, "synch_weights_time_ms": 8.442}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1234, "training_iteration": 38, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-27-25", "timestamp": 1682360845, "time_this_iter_s": 34.63545370101929, "time_total_s": 1372.1974563598633, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1372.1974563598633, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.97234042553191, "ram_util_percent": 47.808510638297854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.44935008846223357, "policy_loss": -0.020525800737086684, "vf_loss": 0.9392594014760107, "vf_explained_var": 0.10168420493602753, "kl": 0.021209761053833064, "entropy": 0.23631754506379365, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 7700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 171.22, "episode_len_mean": 173.22, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0], "episode_lengths": [43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.69436481450305, "mean_inference_ms": 44.148872279650504, "mean_action_processing_ms": 1.6076914505314261, "mean_env_wait_ms": 90.79490377739748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014423370361328125, "ObsPreprocessorConnector_ms": 0.010219097137451172, "StateBufferConnector_ms": 0.008986234664916992, "ViewRequirementAgentConnector_ms": 0.299877405166626}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 171.22, "episode_len_mean": 173.22, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.0, 34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0], "episode_lengths": [43, 36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.69436481450305, "mean_inference_ms": 44.148872279650504, "mean_action_processing_ms": 1.6076914505314261, "mean_env_wait_ms": 90.79490377739748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014423370361328125, "ObsPreprocessorConnector_ms": 0.010219097137451172, "StateBufferConnector_ms": 0.008986234664916992, "ViewRequirementAgentConnector_ms": 0.299877405166626}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 78000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 35480.807, "load_time_ms": 135.838, "load_throughput": 14723.378, "learn_time_ms": 16393.462, "learn_throughput": 122.0, "synch_weights_time_ms": 8.664}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "done": false, "episodes_total": 1240, "training_iteration": 39, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-28-01", "timestamp": 1682360881, "time_this_iter_s": 36.18423581123352, "time_total_s": 1408.3816921710968, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3cd040>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2e0ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1408.3816921710968, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.79795918367347, "ram_util_percent": 46.52653061224489}}
{"evaluation": {"episode_reward_max": 71.0, "episode_reward_min": 9.0, "episode_reward_mean": 39.2, "episode_len_mean": 41.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.0, 71.0, 18.0, 49.0, 65.0, 20.0, 30.0, 9.0, 13.0, 51.0], "episode_lengths": [68, 73, 20, 51, 67, 22, 32, 11, 15, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6736031156597715, "mean_inference_ms": 4.925977822506067, "mean_action_processing_ms": 0.9640375773111979, "mean_env_wait_ms": 52.30239087885077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.011315345764160156, "ObsPreprocessorConnector_ms": 0.010917186737060547, "StateBufferConnector_ms": 0.015065670013427734, "ViewRequirementAgentConnector_ms": 0.21507501602172852}, "num_agent_steps_sampled_this_iter": 412, "num_env_steps_sampled_this_iter": 412, "timesteps_this_iter": 412, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.1319379165582359, "policy_loss": -0.010478987134993076, "vf_loss": 0.28435454713879155, "vf_explained_var": 0.42203786224126816, "kl": 0.020608356618467952, "entropy": 0.18680391892790793, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 7900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 174.09, "episode_len_mean": 176.09, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0], "episode_lengths": [36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.68890613446225, "mean_inference_ms": 44.143079249202714, "mean_action_processing_ms": 1.6077621048779906, "mean_env_wait_ms": 90.79101713896944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014386177062988281, "ObsPreprocessorConnector_ms": 0.010210514068603516, "StateBufferConnector_ms": 0.008968353271484375, "ViewRequirementAgentConnector_ms": 0.29778480529785156}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 174.09, "episode_len_mean": 176.09, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.0, 68.0, 143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0], "episode_lengths": [36, 70, 145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.68890613446225, "mean_inference_ms": 44.143079249202714, "mean_action_processing_ms": 1.6077621048779906, "mean_env_wait_ms": 90.79101713896944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014386177062988281, "ObsPreprocessorConnector_ms": 0.010210514068603516, "StateBufferConnector_ms": 0.008968353271484375, "ViewRequirementAgentConnector_ms": 0.29778480529785156}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 80000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 35491.764, "load_time_ms": 135.487, "load_throughput": 14761.542, "learn_time_ms": 16397.469, "learn_throughput": 121.97, "synch_weights_time_ms": 8.716}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1241, "training_iteration": 40, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-28-41", "timestamp": 1682360921, "time_this_iter_s": 39.32326126098633, "time_total_s": 1447.7049534320831, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2e0700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1447.7049534320831, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.66545454545454, "ram_util_percent": 47.36000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01171875, "cur_lr": 0.00010000000000000002, "total_loss": 0.3555574306519702, "policy_loss": -0.008574363365769387, "vf_loss": 0.728051364782732, "vf_explained_var": 0.06820462316274643, "kl": 0.009245793820543788, "entropy": 0.22375733133405448, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 184.63, "episode_len_mean": 186.63, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0], "episode_lengths": [145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.66397969538052, "mean_inference_ms": 44.10118454630173, "mean_action_processing_ms": 1.6090478729512094, "mean_env_wait_ms": 90.7540370200621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014441251754760742, "ObsPreprocessorConnector_ms": 0.010218381881713867, "StateBufferConnector_ms": 0.008976936340332031, "ViewRequirementAgentConnector_ms": 0.29771876335144043}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 184.63, "episode_len_mean": 186.63, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [143.0, 150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0], "episode_lengths": [145, 152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.66397969538052, "mean_inference_ms": 44.10118454630173, "mean_action_processing_ms": 1.6090478729512094, "mean_env_wait_ms": 90.7540370200621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014441251754760742, "ObsPreprocessorConnector_ms": 0.010218381881713867, "StateBufferConnector_ms": 0.008976936340332031, "ViewRequirementAgentConnector_ms": 0.29771876335144043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 82000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 35346.518, "load_time_ms": 137.712, "load_throughput": 14523.027, "learn_time_ms": 16383.621, "learn_throughput": 122.073, "synch_weights_time_ms": 8.394}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "done": false, "episodes_total": 1243, "training_iteration": 41, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-29-16", "timestamp": 1682360956, "time_this_iter_s": 34.76518249511719, "time_total_s": 1482.4701359272003, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d6dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1482.4701359272003, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.18333333333332, "ram_util_percent": 47.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005859375, "cur_lr": 0.00010000000000000002, "total_loss": 0.07921752780675888, "policy_loss": -0.008367155715823173, "vf_loss": 0.1749486592656467, "vf_explained_var": 0.19058817237615586, "kl": 0.019213410586635293, "entropy": 0.22238952733576298, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 8300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 186.42, "episode_len_mean": 188.42, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0], "episode_lengths": [152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.659972607290726, "mean_inference_ms": 44.09298653792601, "mean_action_processing_ms": 1.60903697426704, "mean_env_wait_ms": 90.75001985994248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01442575454711914, "ObsPreprocessorConnector_ms": 0.011003971099853516, "StateBufferConnector_ms": 0.008966207504272461, "ViewRequirementAgentConnector_ms": 0.2975912094116211}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 186.42, "episode_len_mean": 188.42, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [150.0, 84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0], "episode_lengths": [152, 86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.659972607290726, "mean_inference_ms": 44.09298653792601, "mean_action_processing_ms": 1.60903697426704, "mean_env_wait_ms": 90.75001985994248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01442575454711914, "ObsPreprocessorConnector_ms": 0.011003971099853516, "StateBufferConnector_ms": 0.008966207504272461, "ViewRequirementAgentConnector_ms": 0.2975912094116211}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 84000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 35263.903, "load_time_ms": 136.324, "load_throughput": 14670.949, "learn_time_ms": 16377.87, "learn_throughput": 122.116, "synch_weights_time_ms": 7.846}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1244, "training_iteration": 42, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-29-50", "timestamp": 1682360990, "time_this_iter_s": 34.82936096191406, "time_total_s": 1517.2994968891144, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c580>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2e0f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1517.2994968891144, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.86874999999999, "ram_util_percent": 47.04791666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005859375, "cur_lr": 0.00010000000000000002, "total_loss": 0.1367801818624139, "policy_loss": -0.005913355275988579, "vf_loss": 0.2852441672317218, "vf_explained_var": 0.26447866916656493, "kl": 0.012561877553318937, "entropy": 0.21479420341551303, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 8500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "sampler_results": {"episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 187.9, "episode_len_mean": 189.9, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0], "episode_lengths": [86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.65480789694573, "mean_inference_ms": 44.08479725027716, "mean_action_processing_ms": 1.6090595261122345, "mean_env_wait_ms": 90.7463811642874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014432907104492188, "ObsPreprocessorConnector_ms": 0.011036396026611328, "StateBufferConnector_ms": 0.008972883224487305, "ViewRequirementAgentConnector_ms": 0.29778170585632324}}, "episode_reward_max": 638.0, "episode_reward_min": 34.0, "episode_reward_mean": 187.9, "episode_len_mean": 189.9, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [84.0, 234.0, 283.0, 226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0], "episode_lengths": [86, 236, 285, 228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.65480789694573, "mean_inference_ms": 44.08479725027716, "mean_action_processing_ms": 1.6090595261122345, "mean_env_wait_ms": 90.7463811642874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014432907104492188, "ObsPreprocessorConnector_ms": 0.011036396026611328, "StateBufferConnector_ms": 0.008972883224487305, "ViewRequirementAgentConnector_ms": 0.29778170585632324}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 86000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 35486.711, "load_time_ms": 136.722, "load_throughput": 14628.268, "learn_time_ms": 16423.914, "learn_throughput": 121.774, "synch_weights_time_ms": 7.72}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "done": false, "episodes_total": 1245, "training_iteration": 43, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-30-27", "timestamp": 1682361027, "time_this_iter_s": 36.54582381248474, "time_total_s": 1553.8453207015991, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de6d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1553.8453207015991, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.02, "ram_util_percent": 47.302000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.6356774499826133, "policy_loss": -0.010379090905189514, "vf_loss": 1.2919641455786768, "vf_explained_var": -0.10213523507118225, "kl": 0.026300077178293576, "entropy": 0.2586800018697977, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 756.0, "episode_reward_min": 34.0, "episode_reward_mean": 200.63, "episode_len_mean": 202.63, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0], "episode_lengths": [228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.637441361292577, "mean_inference_ms": 44.06023550320449, "mean_action_processing_ms": 1.6094090555687017, "mean_env_wait_ms": 90.73918482772213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014405488967895508, "ObsPreprocessorConnector_ms": 0.013553619384765625, "StateBufferConnector_ms": 0.008874893188476562, "ViewRequirementAgentConnector_ms": 0.29047584533691406}}, "episode_reward_max": 756.0, "episode_reward_min": 34.0, "episode_reward_mean": 200.63, "episode_len_mean": 202.63, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [226.0, 38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0], "episode_lengths": [228, 40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.637441361292577, "mean_inference_ms": 44.06023550320449, "mean_action_processing_ms": 1.6094090555687017, "mean_env_wait_ms": 90.73918482772213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014405488967895508, "ObsPreprocessorConnector_ms": 0.013553619384765625, "StateBufferConnector_ms": 0.008874893188476562, "ViewRequirementAgentConnector_ms": 0.29047584533691406}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 88000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 35566.207, "load_time_ms": 140.121, "load_throughput": 14273.372, "learn_time_ms": 16444.947, "learn_throughput": 121.618, "synch_weights_time_ms": 8.311}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1248, "training_iteration": 44, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-31-03", "timestamp": 1682361063, "time_this_iter_s": 36.207746505737305, "time_total_s": 1590.0530672073364, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43cdc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1590.0530672073364, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.858, "ram_util_percent": 47.49400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.1880338174616918, "policy_loss": -0.009964390322566033, "vf_loss": 0.39583448981982655, "vf_explained_var": 0.16143005162477495, "kl": 0.028197340996557616, "entropy": 0.16434460438787937, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 8900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 756.0, "episode_reward_min": 34.0, "episode_reward_mean": 205.04, "episode_len_mean": 207.04, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0], "episode_lengths": [40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.638471831541185, "mean_inference_ms": 44.06516317136139, "mean_action_processing_ms": 1.6090005704702017, "mean_env_wait_ms": 90.75090267735926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014455556869506836, "ObsPreprocessorConnector_ms": 0.013356685638427734, "StateBufferConnector_ms": 0.008800506591796875, "ViewRequirementAgentConnector_ms": 0.28827500343322754}}, "episode_reward_max": 756.0, "episode_reward_min": 34.0, "episode_reward_mean": 205.04, "episode_len_mean": 207.04, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.0, 50.0, 550.0, 229.0, 278.0, 34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0], "episode_lengths": [40, 52, 552, 231, 280, 36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.638471831541185, "mean_inference_ms": 44.06516317136139, "mean_action_processing_ms": 1.6090005704702017, "mean_env_wait_ms": 90.75090267735926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014455556869506836, "ObsPreprocessorConnector_ms": 0.013356685638427734, "StateBufferConnector_ms": 0.008800506591796875, "ViewRequirementAgentConnector_ms": 0.28827500343322754}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 90000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 35598.82, "load_time_ms": 146.048, "load_throughput": 13694.171, "learn_time_ms": 16432.519, "learn_throughput": 121.71, "synch_weights_time_ms": 8.77}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 1249, "training_iteration": 45, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-31-40", "timestamp": 1682361100, "time_this_iter_s": 36.16621661186218, "time_total_s": 1626.2192838191986, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43ccd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d6dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1626.2192838191986, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.47, "ram_util_percent": 47.943999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.43723556339740755, "policy_loss": -0.020501144342124463, "vf_loss": 0.9152181087806821, "vf_explained_var": -0.21105236828327179, "kl": 0.04400061821772397, "entropy": 0.12534290853887797, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 9100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 231.85, "episode_len_mean": 233.85, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0], "episode_lengths": [36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.60540264890843, "mean_inference_ms": 44.024844061123204, "mean_action_processing_ms": 1.6093885140971094, "mean_env_wait_ms": 90.74680984277114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014410257339477539, "ObsPreprocessorConnector_ms": 0.01332998275756836, "StateBufferConnector_ms": 0.008765220642089844, "ViewRequirementAgentConnector_ms": 0.2882716655731201}}, "episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 231.85, "episode_len_mean": 233.85, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.0, 79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0], "episode_lengths": [36, 81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.60540264890843, "mean_inference_ms": 44.024844061123204, "mean_action_processing_ms": 1.6093885140971094, "mean_env_wait_ms": 90.74680984277114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014410257339477539, "ObsPreprocessorConnector_ms": 0.01332998275756836, "StateBufferConnector_ms": 0.008765220642089844, "ViewRequirementAgentConnector_ms": 0.2882716655731201}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 92000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 35515.732, "load_time_ms": 145.225, "load_throughput": 13771.711, "learn_time_ms": 16441.306, "learn_throughput": 121.645, "synch_weights_time_ms": 8.315}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1254, "training_iteration": 46, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-32-15", "timestamp": 1682361135, "time_this_iter_s": 34.99229073524475, "time_total_s": 1661.2115745544434, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5e50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd409f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1661.2115745544434, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 84.63958333333333, "ram_util_percent": 47.104166666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.10894443430006504, "policy_loss": -0.011727252639830113, "vf_loss": 0.24117686398036312, "vf_explained_var": 0.23888935267925263, "kl": 0.028901234243903673, "entropy": 0.14163241704925894, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "sampler_results": {"episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 235.42, "episode_len_mean": 237.42, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0], "episode_lengths": [81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5966161768211, "mean_inference_ms": 44.01752008361084, "mean_action_processing_ms": 1.609550483054361, "mean_env_wait_ms": 90.7420547773178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014356136322021484, "ObsPreprocessorConnector_ms": 0.013315439224243164, "StateBufferConnector_ms": 0.008740663528442383, "ViewRequirementAgentConnector_ms": 0.28696751594543457}}, "episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 235.42, "episode_len_mean": 237.42, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [79.0, 54.0, 158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0], "episode_lengths": [81, 56, 160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5966161768211, "mean_inference_ms": 44.01752008361084, "mean_action_processing_ms": 1.609550483054361, "mean_env_wait_ms": 90.7420547773178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014356136322021484, "ObsPreprocessorConnector_ms": 0.013315439224243164, "StateBufferConnector_ms": 0.008740663528442383, "ViewRequirementAgentConnector_ms": 0.28696751594543457}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 94000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 35664.418, "load_time_ms": 143.297, "load_throughput": 13957.042, "learn_time_ms": 16491.292, "learn_throughput": 121.276, "synch_weights_time_ms": 8.658}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "done": false, "episodes_total": 1255, "training_iteration": 47, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-32-51", "timestamp": 1682361171, "time_this_iter_s": 36.35259962081909, "time_total_s": 1697.5641741752625, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf439e20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1697.5641741752625, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.46862745098039, "ram_util_percent": 48.30980392156862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.27547912729904056, "policy_loss": -0.016233726888895034, "vf_loss": 0.5833321474981494, "vf_explained_var": -0.22550111949443818, "kl": 0.01638426526267722, "entropy": 0.1210704880207777, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 9500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 238.87, "episode_len_mean": 240.87, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0], "episode_lengths": [160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5637851085152, "mean_inference_ms": 43.97534228680164, "mean_action_processing_ms": 1.6108441139715615, "mean_env_wait_ms": 90.71305421034434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014289379119873047, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008602619171142578, "ViewRequirementAgentConnector_ms": 0.28310227394104004}}, "episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 238.87, "episode_len_mean": 240.87, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0], "episode_lengths": [160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5637851085152, "mean_inference_ms": 43.97534228680164, "mean_action_processing_ms": 1.6108441139715615, "mean_env_wait_ms": 90.71305421034434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014289379119873047, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008602619171142578, "ViewRequirementAgentConnector_ms": 0.28310227394104004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 96000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 35835.466, "load_time_ms": 143.079, "load_throughput": 13978.255, "learn_time_ms": 16533.352, "learn_throughput": 120.968, "synch_weights_time_ms": 9.32}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1257, "training_iteration": 48, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-33-27", "timestamp": 1682361207, "time_this_iter_s": 36.351208209991455, "time_total_s": 1733.915382385254, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf4f5fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2e09d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1733.915382385254, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.466, "ram_util_percent": 47.666000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0029296875, "cur_lr": 0.00010000000000000002, "total_loss": -0.0044605098012834785, "policy_loss": -0.008865444576367737, "vf_loss": 0.008392754513188265, "vf_explained_var": 0.34299958139657977, "kl": 0.07162567290994047, "entropy": 0.12875322941690684, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 9700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 238.87, "episode_len_mean": 240.87, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0], "episode_lengths": [160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5637851085152, "mean_inference_ms": 43.97534228680164, "mean_action_processing_ms": 1.6108441139715615, "mean_env_wait_ms": 90.71305421034434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014289379119873047, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008602619171142578, "ViewRequirementAgentConnector_ms": 0.28310227394104004}}, "episode_reward_max": 1453.0, "episode_reward_min": 34.0, "episode_reward_mean": 238.87, "episode_len_mean": 240.87, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [158.0, 72.0, 36.0, 62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0], "episode_lengths": [160, 74, 38, 64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.5637851085152, "mean_inference_ms": 43.97534228680164, "mean_action_processing_ms": 1.6108441139715615, "mean_env_wait_ms": 90.71305421034434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014289379119873047, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008602619171142578, "ViewRequirementAgentConnector_ms": 0.28310227394104004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 98000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 36149.204, "load_time_ms": 144.348, "load_throughput": 13855.366, "learn_time_ms": 16503.841, "learn_throughput": 121.184, "synch_weights_time_ms": 9.68}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 1257, "training_iteration": 49, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-34-07", "timestamp": 1682361247, "time_this_iter_s": 39.325854778289795, "time_total_s": 1773.2412371635437, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2e0ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1773.2412371635437, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.66545454545454, "ram_util_percent": 48.61818181818183}}
{"evaluation": {"episode_reward_max": 66.0, "episode_reward_min": 8.0, "episode_reward_mean": 28.1, "episode_len_mean": 30.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 9.0, 14.0, 30.0, 42.0, 8.0, 21.0, 31.0, 15.0, 66.0], "episode_lengths": [47, 11, 16, 32, 44, 10, 23, 33, 17, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.163934982739962, "mean_inference_ms": 4.767166880460886, "mean_action_processing_ms": 0.9131351342568031, "mean_env_wait_ms": 49.34619940244234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.008845329284667969, "ObsPreprocessorConnector_ms": 0.004446506500244141, "StateBufferConnector_ms": 0.005514621734619141, "ViewRequirementAgentConnector_ms": 0.16234159469604492}, "num_agent_steps_sampled_this_iter": 301, "num_env_steps_sampled_this_iter": 301, "timesteps_this_iter": 301, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00439453125, "cur_lr": 0.00010000000000000002, "total_loss": 0.3852677692100406, "policy_loss": -0.016222534254193306, "vf_loss": 0.8021127876237734, "vf_explained_var": -0.11786841422319412, "kl": 0.09909782146787222, "entropy": 0.15764247838407755, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 291.48, "episode_len_mean": 293.48, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0], "episode_lengths": [64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.529638323759958, "mean_inference_ms": 43.94409730941421, "mean_action_processing_ms": 1.6120939207751137, "mean_env_wait_ms": 90.6987441701659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014241933822631836, "ObsPreprocessorConnector_ms": 0.013288497924804688, "StateBufferConnector_ms": 0.00859522819519043, "ViewRequirementAgentConnector_ms": 0.2830541133880615}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 291.48, "episode_len_mean": 293.48, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.0, 72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0], "episode_lengths": [64, 74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.529638323759958, "mean_inference_ms": 43.94409730941421, "mean_action_processing_ms": 1.6120939207751137, "mean_env_wait_ms": 90.6987441701659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014241933822631836, "ObsPreprocessorConnector_ms": 0.013288497924804688, "StateBufferConnector_ms": 0.00859522819519043, "ViewRequirementAgentConnector_ms": 0.2830541133880615}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 100000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 36036.293, "load_time_ms": 144.8, "load_throughput": 13812.112, "learn_time_ms": 16481.369, "learn_throughput": 121.349, "synch_weights_time_ms": 10.05}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1260, "training_iteration": 50, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-34-44", "timestamp": 1682361284, "time_this_iter_s": 36.97458457946777, "time_total_s": 1810.2158217430115, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0eb5ba0820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1810.2158217430115, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 84.0549019607843, "ram_util_percent": 47.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006591796875, "cur_lr": 0.00010000000000000002, "total_loss": 0.014472836581990122, "policy_loss": -0.011502555888146162, "vf_loss": 0.05153165426254418, "vf_explained_var": 0.16892402350902558, "kl": 0.0319481265145987, "entropy": 0.10325135476887226, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 10100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 293.47, "episode_len_mean": 295.47, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0], "episode_lengths": [74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.520446928238922, "mean_inference_ms": 43.93780197572838, "mean_action_processing_ms": 1.6122887262114636, "mean_env_wait_ms": 90.70266417148856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01426553726196289, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008606672286987305, "ViewRequirementAgentConnector_ms": 0.2836019992828369}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 293.47, "episode_len_mean": 295.47, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0], "episode_lengths": [74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.520446928238922, "mean_inference_ms": 43.93780197572838, "mean_action_processing_ms": 1.6122887262114636, "mean_env_wait_ms": 90.70266417148856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01426553726196289, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008606672286987305, "ViewRequirementAgentConnector_ms": 0.2836019992828369}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 102000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 102000, "timers": {"training_iteration_time_ms": 36224.688, "load_time_ms": 142.368, "load_throughput": 14048.086, "learn_time_ms": 16538.152, "learn_throughput": 120.932, "synch_weights_time_ms": 9.86}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "done": false, "episodes_total": 1261, "training_iteration": 51, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-35-20", "timestamp": 1682361320, "time_this_iter_s": 36.6522011756897, "time_total_s": 1846.8680229187012, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c730>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1846.8680229187012, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.63725490196077, "ram_util_percent": 46.6156862745098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006591796875, "cur_lr": 0.00010000000000000002, "total_loss": -0.0042687605507671835, "policy_loss": -0.01111116456799209, "vf_loss": 0.01240678547823336, "vf_explained_var": 0.0535332977771759, "kl": 0.09721361210456962, "entropy": 0.1807671982422471, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 10300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 293.47, "episode_len_mean": 295.47, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0], "episode_lengths": [74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.520446928238922, "mean_inference_ms": 43.93780197572838, "mean_action_processing_ms": 1.6122887262114636, "mean_env_wait_ms": 90.70266417148856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01426553726196289, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008606672286987305, "ViewRequirementAgentConnector_ms": 0.2836019992828369}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 293.47, "episode_len_mean": 295.47, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.0, 100.0, 94.0, 73.0, 60.0, 145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0], "episode_lengths": [74, 102, 96, 75, 62, 147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.520446928238922, "mean_inference_ms": 43.93780197572838, "mean_action_processing_ms": 1.6122887262114636, "mean_env_wait_ms": 90.70266417148856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.01426553726196289, "ObsPreprocessorConnector_ms": 0.013298273086547852, "StateBufferConnector_ms": 0.008606672286987305, "ViewRequirementAgentConnector_ms": 0.2836019992828369}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 104000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 36358.839, "load_time_ms": 142.196, "load_throughput": 14065.083, "learn_time_ms": 16550.913, "learn_throughput": 120.839, "synch_weights_time_ms": 10.507}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1261, "training_iteration": 52, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-35-57", "timestamp": 1682361357, "time_this_iter_s": 36.173391819000244, "time_total_s": 1883.0414147377014, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de820>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1883.0414147377014, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.88600000000001, "ram_util_percent": 49.075999999999986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0098876953125, "cur_lr": 0.00010000000000000002, "total_loss": 0.5988089064694941, "policy_loss": -0.017739522038027644, "vf_loss": 1.2322093174513429, "vf_explained_var": -0.013573537468910218, "kl": 0.04513132377340298, "entropy": 0.24799444407224655, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 335.49, "episode_len_mean": 337.49, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0], "episode_lengths": [147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.486387941359272, "mean_inference_ms": 43.94263045045585, "mean_action_processing_ms": 1.6124573242208637, "mean_env_wait_ms": 90.73708172878895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014171123504638672, "ObsPreprocessorConnector_ms": 0.01347804069519043, "StateBufferConnector_ms": 0.00832986831665039, "ViewRequirementAgentConnector_ms": 0.2803037166595459}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 335.49, "episode_len_mean": 337.49, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 34.0, 202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0], "episode_lengths": [147, 36, 204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.486387941359272, "mean_inference_ms": 43.94263045045585, "mean_action_processing_ms": 1.6124573242208637, "mean_env_wait_ms": 90.73708172878895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014171123504638672, "ObsPreprocessorConnector_ms": 0.01347804069519043, "StateBufferConnector_ms": 0.00832986831665039, "ViewRequirementAgentConnector_ms": 0.2803037166595459}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 106000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 106000, "timers": {"training_iteration_time_ms": 36312.236, "load_time_ms": 143.748, "load_throughput": 13913.198, "learn_time_ms": 16521.873, "learn_throughput": 121.052, "synch_weights_time_ms": 11.282}, "counters": {"num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "done": false, "episodes_total": 1266, "training_iteration": 53, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-36-33", "timestamp": 1682361393, "time_this_iter_s": 36.08643078804016, "time_total_s": 1919.1278455257416, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1919.1278455257416, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.79607843137255, "ram_util_percent": 47.111764705882365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0098876953125, "cur_lr": 0.00010000000000000002, "total_loss": 0.21514005231001648, "policy_loss": -0.008453469276428222, "vf_loss": 0.4456263929873239, "vf_explained_var": -0.05840321242809296, "kl": 0.07912200388140263, "entropy": 0.20177444603294134, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 10700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 351.36, "episode_len_mean": 353.36, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0], "episode_lengths": [204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.45907229389435, "mean_inference_ms": 43.91635365743195, "mean_action_processing_ms": 1.6133860458549734, "mean_env_wait_ms": 90.72440095781836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014299869537353516, "ObsPreprocessorConnector_ms": 0.013169527053833008, "StateBufferConnector_ms": 0.008430719375610352, "ViewRequirementAgentConnector_ms": 0.2790200710296631}}, "episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 351.36, "episode_len_mean": 353.36, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.0, 225.0, 67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0], "episode_lengths": [204, 227, 69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.45907229389435, "mean_inference_ms": 43.91635365743195, "mean_action_processing_ms": 1.6133860458549734, "mean_env_wait_ms": 90.72440095781836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014299869537353516, "ObsPreprocessorConnector_ms": 0.013169527053833008, "StateBufferConnector_ms": 0.008430719375610352, "ViewRequirementAgentConnector_ms": 0.2790200710296631}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 108000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 36195.015, "load_time_ms": 140.228, "load_throughput": 14262.479, "learn_time_ms": 16512.909, "learn_throughput": 121.117, "synch_weights_time_ms": 10.533}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1268, "training_iteration": 54, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-37-08", "timestamp": 1682361428, "time_this_iter_s": 35.02771258354187, "time_total_s": 1954.1555581092834, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3def40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1954.1555581092834, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.58749999999999, "ram_util_percent": 47.34375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.22675953850150107, "policy_loss": -0.015441765710711479, "vf_loss": 0.48342599983589024, "vf_explained_var": 0.25381103247404097, "kl": 0.033053219020657706, "entropy": 0.19344812531024216, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 10900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 365.55, "episode_len_mean": 367.55, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0], "episode_lengths": [69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.436333556364776, "mean_inference_ms": 43.90359344717249, "mean_action_processing_ms": 1.6137868419472963, "mean_env_wait_ms": 90.72613598036476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014281511306762695, "ObsPreprocessorConnector_ms": 0.013278722763061523, "StateBufferConnector_ms": 0.008430242538452148, "ViewRequirementAgentConnector_ms": 0.27851414680480957}}, "episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 365.55, "episode_len_mean": 367.55, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.0, 269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0], "episode_lengths": [69, 271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.436333556364776, "mean_inference_ms": 43.90359344717249, "mean_action_processing_ms": 1.6137868419472963, "mean_env_wait_ms": 90.72613598036476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014281511306762695, "ObsPreprocessorConnector_ms": 0.013278722763061523, "StateBufferConnector_ms": 0.008430242538452148, "ViewRequirementAgentConnector_ms": 0.27851414680480957}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 110000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 110000, "timers": {"training_iteration_time_ms": 36208.846, "load_time_ms": 134.583, "load_throughput": 14860.681, "learn_time_ms": 16542.93, "learn_throughput": 120.898, "synch_weights_time_ms": 10.112}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "done": false, "episodes_total": 1270, "training_iteration": 55, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-37-44", "timestamp": 1682361464, "time_this_iter_s": 36.306904554367065, "time_total_s": 1990.4624626636505, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3dea60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd4093a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 1990.4624626636505, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.396, "ram_util_percent": 47.05999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.13851359765976667, "policy_loss": -0.011221485361456871, "vf_loss": 0.29893865067671865, "vf_explained_var": 0.07425217062234879, "kl": 0.01803782705879712, "entropy": 0.17714727729558943, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 379.65, "episode_len_mean": 381.65, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0], "episode_lengths": [271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.42389948904927, "mean_inference_ms": 43.89733199072238, "mean_action_processing_ms": 1.6139875733947624, "mean_env_wait_ms": 90.7304832368853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014204025268554688, "ObsPreprocessorConnector_ms": 0.013555049896240234, "StateBufferConnector_ms": 0.008424520492553711, "ViewRequirementAgentConnector_ms": 0.2800459861755371}}, "episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 379.65, "episode_len_mean": 381.65, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [269.0, 341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0], "episode_lengths": [271, 343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.42389948904927, "mean_inference_ms": 43.89733199072238, "mean_action_processing_ms": 1.6139875733947624, "mean_env_wait_ms": 90.7304832368853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014204025268554688, "ObsPreprocessorConnector_ms": 0.013555049896240234, "StateBufferConnector_ms": 0.008424520492553711, "ViewRequirementAgentConnector_ms": 0.2800459861755371}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 112000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 36337.82, "load_time_ms": 134.781, "load_throughput": 14838.858, "learn_time_ms": 16568.021, "learn_throughput": 120.714, "synch_weights_time_ms": 10.264}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1271, "training_iteration": 56, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-38-21", "timestamp": 1682361501, "time_this_iter_s": 36.287477016448975, "time_total_s": 2026.7499396800995, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43cfa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2026.7499396800995, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 87.47254901960783, "ram_util_percent": 47.7235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.04527228605002165, "policy_loss": -0.0043006096407771114, "vf_loss": 0.0975578925308946, "vf_explained_var": 0.0555977800488472, "kl": 0.053635674964898496, "entropy": 0.15537380162626505, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 11300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 395.16, "episode_len_mean": 397.16, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0], "episode_lengths": [343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.41886497313855, "mean_inference_ms": 43.905094022480235, "mean_action_processing_ms": 1.6136630428940721, "mean_env_wait_ms": 90.74288332472257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014177560806274414, "ObsPreprocessorConnector_ms": 0.013573169708251953, "StateBufferConnector_ms": 0.007680654525756836, "ViewRequirementAgentConnector_ms": 0.2850048542022705}}, "episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 395.16, "episode_len_mean": 397.16, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0], "episode_lengths": [343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.41886497313855, "mean_inference_ms": 43.905094022480235, "mean_action_processing_ms": 1.6136630428940721, "mean_env_wait_ms": 90.74288332472257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014177560806274414, "ObsPreprocessorConnector_ms": 0.013573169708251953, "StateBufferConnector_ms": 0.007680654525756836, "ViewRequirementAgentConnector_ms": 0.2850048542022705}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 114000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 114000, "timers": {"training_iteration_time_ms": 36261.882, "load_time_ms": 136.418, "load_throughput": 14660.839, "learn_time_ms": 16531.784, "learn_throughput": 120.979, "synch_weights_time_ms": 10.945}, "counters": {"num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "done": false, "episodes_total": 1272, "training_iteration": 57, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-38-56", "timestamp": 1682361536, "time_this_iter_s": 35.598268270492554, "time_total_s": 2062.348207950592, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de2b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2062.348207950592, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.43599999999998, "ram_util_percent": 47.604000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": -0.0056573088467121125, "policy_loss": -0.007228408232331276, "vf_loss": 0.002077650874525716, "vf_explained_var": 0.1277568033337593, "kl": 0.036017127225422885, "entropy": 0.19174093287438154, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 11500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 395.16, "episode_len_mean": 397.16, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0], "episode_lengths": [343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.41886497313855, "mean_inference_ms": 43.905094022480235, "mean_action_processing_ms": 1.6136630428940721, "mean_env_wait_ms": 90.74288332472257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014177560806274414, "ObsPreprocessorConnector_ms": 0.013573169708251953, "StateBufferConnector_ms": 0.007680654525756836, "ViewRequirementAgentConnector_ms": 0.2850048542022705}}, "episode_reward_max": 2169.0, "episode_reward_min": 39.0, "episode_reward_mean": 395.16, "episode_len_mean": 397.16, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.0, 255.0, 92.0, 41.0, 92.0, 296.0, 376.0, 42.0, 178.0, 168.0, 165.0, 81.0, 72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0], "episode_lengths": [343, 257, 94, 43, 94, 298, 378, 44, 180, 170, 167, 83, 74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.41886497313855, "mean_inference_ms": 43.905094022480235, "mean_action_processing_ms": 1.6136630428940721, "mean_env_wait_ms": 90.74288332472257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014177560806274414, "ObsPreprocessorConnector_ms": 0.013573169708251953, "StateBufferConnector_ms": 0.007680654525756836, "ViewRequirementAgentConnector_ms": 0.2850048542022705}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 116000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 36078.784, "load_time_ms": 136.601, "load_throughput": 14641.156, "learn_time_ms": 16503.882, "learn_throughput": 121.184, "synch_weights_time_ms": 10.117}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1272, "training_iteration": 58, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-39-31", "timestamp": 1682361571, "time_this_iter_s": 34.5176100730896, "time_total_s": 2096.8658180236816, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c8b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c1af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2096.8658180236816, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.12978723404255, "ram_util_percent": 48.97234042553193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 1.4331347333639861, "policy_loss": -0.032105488115921614, "vf_loss": 2.929185922765173, "vf_explained_var": 0.07729048550128936, "kl": 0.043803687529143646, "entropy": 0.24134725991636516, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 446.28, "episode_len_mean": 448.28, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0], "episode_lengths": [74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.271633756900265, "mean_inference_ms": 43.80653076948774, "mean_action_processing_ms": 1.6169470765678897, "mean_env_wait_ms": 90.72600607629276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014252424240112305, "ObsPreprocessorConnector_ms": 0.013629674911499023, "StateBufferConnector_ms": 0.007688760757446289, "ViewRequirementAgentConnector_ms": 0.28233790397644043}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 446.28, "episode_len_mean": 448.28, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.0, 43.0, 304.0, 231.0, 90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0], "episode_lengths": [74, 45, 306, 233, 92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.271633756900265, "mean_inference_ms": 43.80653076948774, "mean_action_processing_ms": 1.6169470765678897, "mean_env_wait_ms": 90.72600607629276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014252424240112305, "ObsPreprocessorConnector_ms": 0.013629674911499023, "StateBufferConnector_ms": 0.007688760757446289, "ViewRequirementAgentConnector_ms": 0.28233790397644043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 118000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 118000, "timers": {"training_iteration_time_ms": 35801.297, "load_time_ms": 135.681, "load_throughput": 14740.482, "learn_time_ms": 16530.396, "learn_throughput": 120.989, "synch_weights_time_ms": 9.457}, "counters": {"num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "done": false, "episodes_total": 1284, "training_iteration": 59, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-40-07", "timestamp": 1682361607, "time_this_iter_s": 36.547558069229126, "time_total_s": 2133.4133760929108, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0e0464a490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2133.4133760929108, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.204, "ram_util_percent": 47.04200000000001}}
{"evaluation": {"episode_reward_max": 122.0, "episode_reward_min": 5.0, "episode_reward_mean": 38.36363636363637, "episode_len_mean": 40.36363636363637, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 34.0, 5.0, 28.0, 62.0, 40.0, 122.0, 18.0, 17.0, 46.0, 17.0], "episode_lengths": [35, 36, 7, 30, 64, 42, 124, 20, 19, 48, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.744200558841978, "mean_inference_ms": 4.809794565623775, "mean_action_processing_ms": 0.9152180978942615, "mean_env_wait_ms": 50.094680307300514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.010704994201660156, "ObsPreprocessorConnector_ms": 0.009892203591086647, "StateBufferConnector_ms": 0.009504231539639559, "ViewRequirementAgentConnector_ms": 0.22837031971324573}, "num_agent_steps_sampled_this_iter": 444, "num_env_steps_sampled_this_iter": 444, "timesteps_this_iter": 444, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.48387296468485147, "policy_loss": -0.016118377819657324, "vf_loss": 0.9990133666503244, "vf_explained_var": -0.09749233305454254, "kl": 0.03283374161028405, "entropy": 0.23230616878718138, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 11900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 460.09, "episode_len_mean": 462.09, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0], "episode_lengths": [92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.2293067787912, "mean_inference_ms": 43.81154150568416, "mean_action_processing_ms": 1.6168808090164515, "mean_env_wait_ms": 90.75031709125382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014292001724243164, "ObsPreprocessorConnector_ms": 0.013442277908325195, "StateBufferConnector_ms": 0.007691621780395508, "ViewRequirementAgentConnector_ms": 0.28523683547973633}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 460.09, "episode_len_mean": 462.09, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [90.0, 98.0, 106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0], "episode_lengths": [92, 100, 108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.2293067787912, "mean_inference_ms": 43.81154150568416, "mean_action_processing_ms": 1.6168808090164515, "mean_env_wait_ms": 90.75031709125382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014292001724243164, "ObsPreprocessorConnector_ms": 0.013442277908325195, "StateBufferConnector_ms": 0.007691621780395508, "ViewRequirementAgentConnector_ms": 0.28523683547973633}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 120000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 35967.92, "load_time_ms": 135.549, "load_throughput": 14754.786, "learn_time_ms": 16570.526, "learn_throughput": 120.696, "synch_weights_time_ms": 9.222}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1288, "training_iteration": 60, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-40-46", "timestamp": 1682361646, "time_this_iter_s": 38.83740472793579, "time_total_s": 2172.2507808208466, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd4093a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2172.2507808208466, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 79.96296296296296, "ram_util_percent": 46.84444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.01483154296875, "cur_lr": 0.00010000000000000002, "total_loss": 0.2762632704898715, "policy_loss": -0.008540231958031655, "vf_loss": 0.5693061660369858, "vf_explained_var": -0.38386005312204363, "kl": 0.010302637851964391, "entropy": 0.23810446567833424, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 12100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 492.94, "episode_len_mean": 494.94, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0], "episode_lengths": [108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.20841255388643, "mean_inference_ms": 43.81340460194822, "mean_action_processing_ms": 1.6168467640072022, "mean_env_wait_ms": 90.76159371239041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014303922653198242, "ObsPreprocessorConnector_ms": 0.013425827026367188, "StateBufferConnector_ms": 0.0073969364166259766, "ViewRequirementAgentConnector_ms": 0.28136372566223145}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 492.94, "episode_len_mean": 494.94, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0], "episode_lengths": [108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.20841255388643, "mean_inference_ms": 43.81340460194822, "mean_action_processing_ms": 1.6168467640072022, "mean_env_wait_ms": 90.76159371239041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014303922653198242, "ObsPreprocessorConnector_ms": 0.013425827026367188, "StateBufferConnector_ms": 0.0073969364166259766, "ViewRequirementAgentConnector_ms": 0.28136372566223145}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 122000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 122000, "timers": {"training_iteration_time_ms": 35836.76, "load_time_ms": 138.567, "load_throughput": 14433.494, "learn_time_ms": 16523.815, "learn_throughput": 121.037, "synch_weights_time_ms": 9.918}, "counters": {"num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "done": false, "episodes_total": 1290, "training_iteration": 61, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-41-22", "timestamp": 1682361682, "time_this_iter_s": 35.34293270111084, "time_total_s": 2207.5937135219574, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2207.5937135219574, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.874, "ram_util_percent": 47.72999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": -0.014172177202999592, "policy_loss": -0.01963821616023779, "vf_loss": 0.010200288305495632, "vf_explained_var": -0.08980510324239731, "kl": 0.04967779865434732, "entropy": 0.25045605562627316, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 492.94, "episode_len_mean": 494.94, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0], "episode_lengths": [108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.20841255388643, "mean_inference_ms": 43.81340460194822, "mean_action_processing_ms": 1.6168467640072022, "mean_env_wait_ms": 90.76159371239041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014303922653198242, "ObsPreprocessorConnector_ms": 0.013425827026367188, "StateBufferConnector_ms": 0.0073969364166259766, "ViewRequirementAgentConnector_ms": 0.28136372566223145}}, "episode_reward_max": 2169.0, "episode_reward_min": 34.0, "episode_reward_mean": 492.94, "episode_len_mean": 494.94, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.0, 638.0, 39.0, 142.0, 129.0, 210.0, 98.0, 274.0, 65.0, 154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0], "episode_lengths": [108, 640, 41, 144, 131, 212, 100, 276, 67, 156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.20841255388643, "mean_inference_ms": 43.81340460194822, "mean_action_processing_ms": 1.6168467640072022, "mean_env_wait_ms": 90.76159371239041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014303922653198242, "ObsPreprocessorConnector_ms": 0.013425827026367188, "StateBufferConnector_ms": 0.0073969364166259766, "ViewRequirementAgentConnector_ms": 0.28136372566223145}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 124000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 35668.775, "load_time_ms": 138.016, "load_throughput": 14491.068, "learn_time_ms": 16522.237, "learn_throughput": 121.049, "synch_weights_time_ms": 9.41}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1290, "training_iteration": 62, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-41-56", "timestamp": 1682361716, "time_this_iter_s": 34.49025583267212, "time_total_s": 2242.0839693546295, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de6a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2242.0839693546295, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.00212765957447, "ram_util_percent": 48.421276595744686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 1.1142171963583678, "policy_loss": -0.021065106152091177, "vf_loss": 2.269969078276772, "vf_explained_var": -0.05192714631557464, "kl": 0.04064778558484249, "entropy": 0.36625180818140507, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 12500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 563.31, "episode_len_mean": 565.31, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0], "episode_lengths": [156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.08385119974435, "mean_inference_ms": 43.73868373601099, "mean_action_processing_ms": 1.619673052148189, "mean_env_wait_ms": 90.76186157803495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014060020446777344, "ObsPreprocessorConnector_ms": 0.012965679168701172, "StateBufferConnector_ms": 0.007279634475708008, "ViewRequirementAgentConnector_ms": 0.28260135650634766}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 563.31, "episode_len_mean": 565.31, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [154.0, 82.0, 100.0, 219.0, 80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0], "episode_lengths": [156, 84, 102, 221, 82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.08385119974435, "mean_inference_ms": 43.73868373601099, "mean_action_processing_ms": 1.619673052148189, "mean_env_wait_ms": 90.76186157803495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014060020446777344, "ObsPreprocessorConnector_ms": 0.012965679168701172, "StateBufferConnector_ms": 0.007279634475708008, "ViewRequirementAgentConnector_ms": 0.28260135650634766}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 126000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 35621.164, "load_time_ms": 135.952, "load_throughput": 14711.116, "learn_time_ms": 16526.93, "learn_throughput": 121.015, "synch_weights_time_ms": 8.551}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 1299, "training_iteration": 63, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-42-32", "timestamp": 1682361752, "time_this_iter_s": 35.60740041732788, "time_total_s": 2277.6913697719574, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf439e20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c1d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2277.6913697719574, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 81.98367346938777, "ram_util_percent": 48.00204081632653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 0.4091790397465229, "policy_loss": -0.02078585624694824, "vf_loss": 0.859552977825515, "vf_explained_var": -0.0622672426700592, "kl": 0.025806539348068327, "entropy": 0.29759566742926835, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 12700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 574.82, "episode_len_mean": 576.82, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0], "episode_lengths": [82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.027477495821714, "mean_inference_ms": 43.71810907149279, "mean_action_processing_ms": 1.6205907330324063, "mean_env_wait_ms": 90.77452276381227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013384103775024414, "ObsPreprocessorConnector_ms": 0.01297903060913086, "StateBufferConnector_ms": 0.007330656051635742, "ViewRequirementAgentConnector_ms": 0.28101444244384766}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 574.82, "episode_len_mean": 576.82, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 156.0, 230.0, 290.0, 69.0, 599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0], "episode_lengths": [82, 158, 232, 292, 71, 601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.027477495821714, "mean_inference_ms": 43.71810907149279, "mean_action_processing_ms": 1.6205907330324063, "mean_env_wait_ms": 90.77452276381227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013384103775024414, "ObsPreprocessorConnector_ms": 0.01297903060913086, "StateBufferConnector_ms": 0.007330656051635742, "ViewRequirementAgentConnector_ms": 0.28101444244384766}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 128000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 35807.161, "load_time_ms": 136.132, "load_throughput": 14691.633, "learn_time_ms": 16593.304, "learn_throughput": 120.531, "synch_weights_time_ms": 8.839}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1303, "training_iteration": 64, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-43-09", "timestamp": 1682361789, "time_this_iter_s": 36.89315605163574, "time_total_s": 2314.584525823593, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c250>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd35ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2314.584525823593, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.166, "ram_util_percent": 47.69800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 0.23375125892460347, "policy_loss": -0.023844009566819296, "vf_loss": 0.5148060495196841, "vf_explained_var": -0.0037854495644569397, "kl": 0.026264086180672167, "entropy": 0.2530228266865015, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 12900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 579.93, "episode_len_mean": 581.93, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0], "episode_lengths": [601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.958630496126563, "mean_inference_ms": 43.687774978786685, "mean_action_processing_ms": 1.622422518231989, "mean_env_wait_ms": 90.77655579824076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013533592224121094, "ObsPreprocessorConnector_ms": 0.012877464294433594, "StateBufferConnector_ms": 0.007449150085449219, "ViewRequirementAgentConnector_ms": 0.28616929054260254}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 579.93, "episode_len_mean": 581.93, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [599.0, 131.0, 117.0, 88.0, 120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0], "episode_lengths": [601, 133, 119, 90, 122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.958630496126563, "mean_inference_ms": 43.687774978786685, "mean_action_processing_ms": 1.622422518231989, "mean_env_wait_ms": 90.77655579824076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.013533592224121094, "ObsPreprocessorConnector_ms": 0.012877464294433594, "StateBufferConnector_ms": 0.007449150085449219, "ViewRequirementAgentConnector_ms": 0.28616929054260254}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 130000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 130000, "timers": {"training_iteration_time_ms": 35788.699, "load_time_ms": 137.367, "load_throughput": 14559.559, "learn_time_ms": 16557.377, "learn_throughput": 120.792, "synch_weights_time_ms": 8.966}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "done": false, "episodes_total": 1308, "training_iteration": 65, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-43-45", "timestamp": 1682361825, "time_this_iter_s": 36.12421154975891, "time_total_s": 2350.708737373352, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddc2d69d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2350.708737373352, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 83.28627450980393, "ram_util_percent": 47.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 0.5743693168781465, "policy_loss": -0.015018840581178665, "vf_loss": 1.1784682250581682, "vf_explained_var": -0.38925317317247393, "kl": 0.021150957690958875, "entropy": 0.2811424643546343, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 13100.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 585.97, "episode_len_mean": 587.97, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0], "episode_lengths": [122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.907582666816438, "mean_inference_ms": 43.675137127165364, "mean_action_processing_ms": 1.6233812529221263, "mean_env_wait_ms": 90.78567098546885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014288187026977539, "ObsPreprocessorConnector_ms": 0.013126134872436523, "StateBufferConnector_ms": 0.00747227668762207, "ViewRequirementAgentConnector_ms": 0.286893367767334}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 585.97, "episode_len_mean": 587.97, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.0, 105.0, 227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0], "episode_lengths": [122, 107, 229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.907582666816438, "mean_inference_ms": 43.675137127165364, "mean_action_processing_ms": 1.6233812529221263, "mean_env_wait_ms": 90.78567098546885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014288187026977539, "ObsPreprocessorConnector_ms": 0.013126134872436523, "StateBufferConnector_ms": 0.00747227668762207, "ViewRequirementAgentConnector_ms": 0.286893367767334}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 132000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 35688.499, "load_time_ms": 138.503, "load_throughput": 14440.113, "learn_time_ms": 16529.976, "learn_throughput": 120.992, "synch_weights_time_ms": 9.321}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1312, "training_iteration": 66, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-44-20", "timestamp": 1682361860, "time_this_iter_s": 35.28667664527893, "time_total_s": 2385.995414018631, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3dee80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c0ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2385.995414018631, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 86.62857142857143, "ram_util_percent": 48.432653061224485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 0.31395835117669774, "policy_loss": -0.016461237147450448, "vf_loss": 0.6600220159132733, "vf_explained_var": -0.4462722501158714, "kl": 0.05537219392452244, "entropy": 0.2045335813239217, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 13300.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 588.26, "episode_len_mean": 590.26, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0], "episode_lengths": [229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.878715894447696, "mean_inference_ms": 43.66836495458258, "mean_action_processing_ms": 1.6239125485731711, "mean_env_wait_ms": 90.79605047283518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014348745346069336, "ObsPreprocessorConnector_ms": 0.012809991836547852, "StateBufferConnector_ms": 0.007496356964111328, "ViewRequirementAgentConnector_ms": 0.29353857040405273}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 588.26, "episode_len_mean": 590.26, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [227.0, 324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0], "episode_lengths": [229, 326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.878715894447696, "mean_inference_ms": 43.66836495458258, "mean_action_processing_ms": 1.6239125485731711, "mean_env_wait_ms": 90.79605047283518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014348745346069336, "ObsPreprocessorConnector_ms": 0.012809991836547852, "StateBufferConnector_ms": 0.007496356964111328, "ViewRequirementAgentConnector_ms": 0.29353857040405273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 134000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 134000, "timers": {"training_iteration_time_ms": 35985.273, "load_time_ms": 136.756, "load_throughput": 14624.557, "learn_time_ms": 16553.407, "learn_throughput": 120.821, "synch_weights_time_ms": 8.532}, "counters": {"num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "done": false, "episodes_total": 1314, "training_iteration": 67, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-44-59", "timestamp": 1682361899, "time_this_iter_s": 38.56181526184082, "time_total_s": 2424.557229280472, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3def70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2424.557229280472, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 82.64444444444449, "ram_util_percent": 48.72777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007415771484375, "cur_lr": 0.00010000000000000002, "total_loss": 0.15082855347543955, "policy_loss": -0.004005431793630123, "vf_loss": 0.30952977747336263, "vf_explained_var": -0.15909211605787277, "kl": 0.009609877807233715, "entropy": 0.21699624713510274, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 13500.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 586.88, "episode_len_mean": 588.88, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0], "episode_lengths": [326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.863788935759171, "mean_inference_ms": 43.66518245070543, "mean_action_processing_ms": 1.624197004213693, "mean_env_wait_ms": 90.80187688023925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014365196228027344, "ObsPreprocessorConnector_ms": 0.013031721115112305, "StateBufferConnector_ms": 0.007502317428588867, "ViewRequirementAgentConnector_ms": 0.2935819625854492}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 586.88, "episode_len_mean": 588.88, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [324.0, 273.0, 53.0, 157.0, 318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0], "episode_lengths": [326, 275, 55, 159, 320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.863788935759171, "mean_inference_ms": 43.66518245070543, "mean_action_processing_ms": 1.624197004213693, "mean_env_wait_ms": 90.80187688023925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014365196228027344, "ObsPreprocessorConnector_ms": 0.013031721115112305, "StateBufferConnector_ms": 0.007502317428588867, "ViewRequirementAgentConnector_ms": 0.2935819625854492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 136000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 36245.869, "load_time_ms": 136.698, "load_throughput": 14630.74, "learn_time_ms": 16635.677, "learn_throughput": 120.224, "synch_weights_time_ms": 8.638}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1315, "training_iteration": 68, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-45-36", "timestamp": 1682361936, "time_this_iter_s": 37.121987104415894, "time_total_s": 2461.6792163848877, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c280>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c0dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2461.6792163848877, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 80.33725490196078, "ram_util_percent": 48.71960784313726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0037078857421875, "cur_lr": 0.00010000000000000002, "total_loss": 0.4251949978712946, "policy_loss": -0.013851275071501731, "vf_loss": 0.8780034383467864, "vf_explained_var": -0.1224602910876274, "kl": 0.012496958026131324, "entropy": 0.1789005981385708, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 13700.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 608.79, "episode_len_mean": 610.79, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0, 1568.0, 963.0, 171.0, 296.0], "episode_lengths": [320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91, 1570, 965, 173, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.790181329520326, "mean_inference_ms": 43.614528681149686, "mean_action_processing_ms": 1.6265419081607166, "mean_env_wait_ms": 90.77955019482886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014108657836914062, "ObsPreprocessorConnector_ms": 0.013030529022216797, "StateBufferConnector_ms": 0.007455348968505859, "ViewRequirementAgentConnector_ms": 0.3217644691467285}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 608.79, "episode_len_mean": 610.79, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0, 1568.0, 963.0, 171.0, 296.0], "episode_lengths": [320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91, 1570, 965, 173, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.790181329520326, "mean_inference_ms": 43.614528681149686, "mean_action_processing_ms": 1.6265419081607166, "mean_env_wait_ms": 90.77955019482886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014108657836914062, "ObsPreprocessorConnector_ms": 0.013030529022216797, "StateBufferConnector_ms": 0.007455348968505859, "ViewRequirementAgentConnector_ms": 0.3217644691467285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 138000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 36231.572, "load_time_ms": 139.505, "load_throughput": 14336.389, "learn_time_ms": 16612.907, "learn_throughput": 120.388, "synch_weights_time_ms": 9.015}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "done": false, "episodes_total": 1319, "training_iteration": 69, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-46-12", "timestamp": 1682361972, "time_this_iter_s": 36.40694332122803, "time_total_s": 2498.0861597061157, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddf43c490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3c1d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2498.0861597061157, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 84.09607843137255, "ram_util_percent": 47.68431372549019}}
{"evaluation": {"episode_reward_max": 134.0, "episode_reward_min": 9.0, "episode_reward_mean": 35.2, "episode_len_mean": 37.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 33.0, 10.0, 15.0, 9.0, 134.0, 25.0, 50.0, 17.0, 24.0], "episode_lengths": [37, 35, 12, 17, 11, 136, 27, 52, 19, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.600421414655797, "mean_inference_ms": 4.711867255323073, "mean_action_processing_ms": 0.8894731016720042, "mean_env_wait_ms": 48.6995551516028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.008389949798583984, "ObsPreprocessorConnector_ms": 0.0043582916259765625, "StateBufferConnector_ms": 0.007646083831787109, "ViewRequirementAgentConnector_ms": 0.15719890594482422}, "num_agent_steps_sampled_this_iter": 372, "num_env_steps_sampled_this_iter": 372, "timesteps_this_iter": 372, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00185394287109375, "cur_lr": 0.00010000000000000002, "total_loss": -0.007566014649346471, "policy_loss": -0.013240258377045393, "vf_loss": 0.011229686395308818, "vf_explained_var": 0.048221930265426635, "kl": 0.032965004139377925, "entropy": 0.1716414389386773, "entropy_coeff": 1e-05}, "model": {}, "num_grad_updates_lifetime": 13900.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 608.79, "episode_len_mean": 610.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0, 1568.0, 963.0, 171.0, 296.0], "episode_lengths": [320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91, 1570, 965, 173, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.790181329520326, "mean_inference_ms": 43.614528681149686, "mean_action_processing_ms": 1.6265419081607166, "mean_env_wait_ms": 90.77955019482886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014108657836914062, "ObsPreprocessorConnector_ms": 0.013030529022216797, "StateBufferConnector_ms": 0.007455348968505859, "ViewRequirementAgentConnector_ms": 0.3217644691467285}}, "episode_reward_max": 2766.0, "episode_reward_min": 34.0, "episode_reward_mean": 608.79, "episode_len_mean": 610.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [318.0, 80.0, 176.0, 412.0, 86.0, 262.0, 328.0, 97.0, 43.0, 443.0, 80.0, 398.0, 57.0, 402.0, 41.0, 299.0, 248.0, 48.0, 491.0, 186.0, 143.0, 328.0, 572.0, 584.0, 322.0, 298.0, 555.0, 756.0, 563.0, 667.0, 423.0, 116.0, 690.0, 1144.0, 1453.0, 391.0, 212.0, 266.0, 1787.0, 2169.0, 1571.0, 261.0, 263.0, 48.0, 1861.0, 897.0, 1532.0, 134.0, 1632.0, 966.0, 880.0, 1477.0, 1820.0, 418.0, 1199.0, 245.0, 47.0, 587.0, 2009.0, 376.0, 610.0, 520.0, 34.0, 310.0, 884.0, 94.0, 512.0, 51.0, 1374.0, 1939.0, 1534.0, 264.0, 1302.0, 1915.0, 310.0, 1449.0, 295.0, 381.0, 56.0, 2766.0, 270.0, 41.0, 1350.0, 45.0, 539.0, 120.0, 581.0, 35.0, 61.0, 106.0, 207.0, 681.0, 545.0, 264.0, 190.0, 89.0, 1568.0, 963.0, 171.0, 296.0], "episode_lengths": [320, 82, 178, 414, 88, 264, 330, 99, 45, 445, 82, 400, 59, 404, 43, 301, 250, 50, 493, 188, 145, 330, 574, 586, 324, 300, 557, 758, 565, 669, 425, 118, 692, 1146, 1455, 393, 214, 268, 1789, 2171, 1573, 263, 265, 50, 1863, 899, 1534, 136, 1634, 968, 882, 1479, 1822, 420, 1201, 247, 49, 589, 2011, 378, 612, 522, 36, 312, 886, 96, 514, 53, 1376, 1941, 1536, 266, 1304, 1917, 312, 1451, 297, 383, 58, 2768, 272, 43, 1352, 47, 541, 122, 583, 37, 63, 108, 209, 683, 547, 266, 192, 91, 1570, 965, 173, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.790181329520326, "mean_inference_ms": 43.614528681149686, "mean_action_processing_ms": 1.6265419081607166, "mean_env_wait_ms": 90.77955019482886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.014108657836914062, "ObsPreprocessorConnector_ms": 0.013030529022216797, "StateBufferConnector_ms": 0.007455348968505859, "ViewRequirementAgentConnector_ms": 0.3217644691467285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "timesteps_total": 140000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 36099.64, "load_time_ms": 141.509, "load_throughput": 14133.421, "learn_time_ms": 16577.996, "learn_throughput": 120.642, "synch_weights_time_ms": 9.791}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1319, "training_iteration": 70, "trial_id": "698ea_00000", "experiment_id": "dbbe7b0597884cd8acb268d114768532", "date": "2023-04-24_18-46-49", "timestamp": 1682362009, "time_this_iter_s": 36.898804903030396, "time_total_s": 2534.984964609146, "pid": 6914, "hostname": "d54561fa162c", "node_ip": "172.28.0.12", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1.0, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "snake", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.0003, "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [1024, 512, 512], "fcnet_activation": "than", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [64, [5, 5], 5], [128, [5, 5], 5]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 224, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling", "random_timesteps": 5000}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0ddd3de310>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": 2000, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[500000, 0.0001]], "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 200, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": [[200000, 0.01], [500000, 0.001], [800000, 0.0001], [1100000, 1e-05]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.03, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0ddd3f6d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 0.0, "num_workers": 2}, "time_since_restore": 2534.984964609146, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 14.60972547531128, "perf": {"cpu_util_percent": 85.56200000000001, "ram_util_percent": 49.13799999999999}}
